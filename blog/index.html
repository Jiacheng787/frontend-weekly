<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="alternate" type="application/rss+xml" href="/frontend-weekly/blog/rss.xml" title="Frontend Weekly RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/frontend-weekly/blog/atom.xml" title="Frontend Weekly Atom Feed"><title data-rh="true">Blog | Frontend Weekly</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/frontend-weekly/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | Frontend Weekly"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/frontend-weekly/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/frontend-weekly/blog"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/frontend-weekly/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/frontend-weekly/blog" hreflang="x-default"><link rel="stylesheet" href="/frontend-weekly/assets/css/styles.406a5f2d.css">
<link rel="preload" href="/frontend-weekly/assets/js/runtime~main.a6d94b7a.js" as="script">
<link rel="preload" href="/frontend-weekly/assets/js/main.30b81cc3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/frontend-weekly/"><div class="navbar__logo"><img src="/frontend-weekly/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/frontend-weekly/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Frontend Weekly</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/frontend-weekly/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/garfield-dev-team/frontend-weekly/tree/main/static/img/IMG_0058.JPG" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">⭐️ 前端交流群<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/garfield-dev-team/frontend-weekly" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All our posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/welcome">置顶内容</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/9月18日内容汇总">9月18日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/9月11日内容汇总">9月11日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/9月4日内容汇总">9月4日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/8月28日内容汇总">8月28日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/8月21日内容汇总">8月21日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/8月14日内容汇总">8月14日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/8月7日内容汇总">8月7日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/7月31日内容汇总">7月31日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/7月24日内容汇总">7月24日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/7月17日内容汇总">7月17日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/7月10日内容汇总">7月10日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/7月3日内容汇总">7月3日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/6月26日内容汇总">6月26日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/6月19日内容汇总">6月19日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/6月12日内容汇总">6月12日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/6月5日内容汇总">6月5日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/5月29日内容汇总">5月29日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/5月22日内容汇总">5月22日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/5月15日内容汇总">5月15日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/5月8日内容汇总">5月8日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/5月1日内容汇总">5月1日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/4月24日内容汇总">4月24日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/4月17日内容汇总">4月17日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/4月10日内容汇总">4月10日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/4月3日内容汇总">4月3日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/3月27日内容汇总">3月27日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/3月20日内容汇总">3月20日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/3月13日内容汇总">3月13日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/3月6日内容汇总">3月6日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/2月27日内容汇总">2月27日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/2月20日内容汇总">2月20日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/2月13日内容汇总">2月13日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/2月6日内容汇总">2月6日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/1月30日内容汇总">1月30日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/1月23日内容汇总">1月23日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/1月16日内容汇总">1月16日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/1月9日内容汇总">1月9日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/1月2日内容汇总">1月2日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/12月26日内容汇总">12月26日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/12月19日内容汇总">12月19日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/12月12日内容汇总">12月12日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/12月5日内容汇总">12月5日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/11月28日内容汇总">11月28日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/11月21日内容汇总">11月21日内容汇总</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/frontend-weekly/blog/11月14日内容汇总">11月14日内容汇总</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/welcome">置顶内容</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-12T00:00:00.000Z" itemprop="datePublished">December 12, 2022</time> · <!-- -->68 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>⭐️ 每周更新优质技术文章，欢迎点赞关注！</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/type-script">TypeScript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/前端框架">前端框架</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/webpack">Webpack</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/源码系列">源码系列</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/业务成长">业务成长</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/性能优化">性能优化</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/组件库实战">组件库实战</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/网络相关">网络相关</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/机器学习">机器学习</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/java">Java</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/frontend-weekly/blog/tags/golang">Golang</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about 置顶内容" href="/frontend-weekly/blog/welcome"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/9月18日内容汇总">9月18日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-09-18T00:00:00.000Z" itemprop="datePublished">September 18, 2022</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://mp.weixin.qq.com/s/-685DKQuzTEbsg0pZzQSVg" target="_blank" rel="noopener noreferrer">ECMAScript 2023将新增的9个数组方法</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/BPFJSkvv_UPMux0dSZuh-A" target="_blank" rel="noopener noreferrer">关于 React Re-Render</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/qFSzt32BjFW_Gl5OpI3lXA" target="_blank" rel="noopener noreferrer">Go：基于 Redis 实现的延迟队列详解</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/k0eYoJuL0JO_tHEiU887wA" target="_blank" rel="noopener noreferrer">这个帮你理清Go程序调用栈的工具，1.17以上可用</a></p><p>📒 <a href="https://juejin.cn/post/7127161983622725639" target="_blank" rel="noopener noreferrer">一起来实现一个Antd Form</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/vzSbdOFrwpA2U0JpMx_nsw" target="_blank" rel="noopener noreferrer">如何检测 JavaScript 原生函数是否被打过 &quot;猴子补丁&quot;</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/56tth8PSquB1eR5-1XaDWA" target="_blank" rel="noopener noreferrer">鹅厂后台大佬教你Go内存管理！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/VKpHtRVIJh669SLz2nUJuQ" target="_blank" rel="noopener noreferrer">Plasmo Framework：次世代的浏览器插件开发框架</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/NkSyv7iDSZsLhMUgAi-r4w" target="_blank" rel="noopener noreferrer">不得不知道的Golang之sync.Map解读！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/_sZiClAyq1MDrh7XoIgSBQ" target="_blank" rel="noopener noreferrer">前端食堂技术周刊第 52 期：Babel 7.19.0、Fresh 1.1、React为什么重新渲染、新的 Web 性能指标</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/kn7cHvZvjR93V0CW06e0NQ" target="_blank" rel="noopener noreferrer">我被骂了，但我学会了如何构造高性能的树状结构</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/tfZ5zHo8FG_Rc1JteLBS7g" target="_blank" rel="noopener noreferrer">「Go工具箱」一个将非负整数转换成唯一、无序ID的工具：hashids</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/URJC9ERPrcniiFinUsIJkg" target="_blank" rel="noopener noreferrer">【图书】程序员的底层思维</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/iTFj1Sn5vPTgkAT2Q9YC0w" target="_blank" rel="noopener noreferrer">作为大厂面试官，原来这种学生最吃香！</a></p><p>📒 Why Storybook in 2022</p><blockquote><p><a href="https://storybook.js.org/blog/why-storybook-in-2022/" target="_blank" rel="noopener noreferrer">https://storybook.js.org/blog/why-storybook-in-2022/</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/59x3uElLaSZVf77itv8B3Q" target="_blank" rel="noopener noreferrer">如何像gitlab-runner那样将Go应用安装为系统服务</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/8JPj9Rz5xyrnAloeno0RNA" target="_blank" rel="noopener noreferrer">React Router v6 完全指南</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/81L1RRiCdqGMJmk-iUZldg" target="_blank" rel="noopener noreferrer">【第2726期】开发模式 &quot;Development Mode&quot; 是如何工作的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/FdCl0BZT_v_pjBZKcTUnoQ" target="_blank" rel="noopener noreferrer">你信吗？Go 泛型竟然已经被迅速采用</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/jzCfXs6jz820XOHksZzBDA" target="_blank" rel="noopener noreferrer">做一个不崩溃的核酸系统到底有多难</a></p><p>📒 <a href="https://juejin.cn/post/7142371499255529509" target="_blank" rel="noopener noreferrer">写给前端仔的自动化测试入门小作文</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/MN4wsITSVYHNMPoFRpRZFQ" target="_blank" rel="noopener noreferrer">「Go工具箱」一个兼具单机和集群模式的轻量级限流器：throttled</a></p><p>📒 CSR 最佳实践</p><p>随着 Next.js 和 Remix 的流行，SSR 看似已成为 React 社区的首选。但如果你用 SSR 是为了性能和 SEO，那可能可以重新考虑下，因为 CSR 也能做到。</p><p>关于性能。</p><p>1、减少尺寸。1）少用依赖，2）选择轻量级的依赖，比如用 day.js 代替 moment，用 zustand 代替 redux toolkit。</p><p>2、缓存。利用 webpack 的 cacheGroups 设置，提取依赖，当依赖没有变更时，hash 值不变，提高缓存利用率。推荐配置如下，让每个依赖拥有单独的文件和 hash，这样单个依赖变更时不会影响其他依赖。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">optimization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">runtimeChunk</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;single&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">splitChunks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">chunks</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;initial&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">cacheGroups</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">vendor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">[\\/]node_modules[\\/]</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 加这句可以避免异步 chunk 的 vendor 重复问题，比如 a 和 b 都依赖 moment，不加这句 moment 会被打两遍而不是被提取出来</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">chunk</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;all&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 让每个依赖拥有单独的文件和 hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> context </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">match</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">[\\/]node_modules[\\/](.*?)([\\/]|$)</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>3、Code Splitting。通常有两种，1）基于路由的 Code Splitting，当用户访问页面 A 时无需加载页面 B、C、D 的脚本，2）大依赖 Code Splitting，让整体页面更快出来，让大依赖的部分不影响页面渲染速度。</p><p>4、预加载异步 Chunk。主要避免出现下图中最后一个资源文件的瀑布流现象，思路是生成和路由对应的 assets 表，然后在 HTML 最前面加入「匹配路由生成 link preload 标签」的脚本。</p><p>5、生成静态数据。在 build 阶段从 CMD 或服务器上把数据拉下来，存成 json 或其他格式，用户请求时就只需从本地读取即可，访问本地或就近的 CDN 肯定比访问远程服务器更快。如果要重新生成数据，重新跑 build 或者重新执行脚本就好。</p><p>6、预加载数据。这和「4」类似，4 预加载的是 JS，这里需要预加载数据。做法也和「4」类似，把数据请求和路由做关联，然后运行时「匹配路由生成针对数据请求的 link preload 标签」。</p><p>7、预加载其他页面的数据。当 hover（desktop）或进入 viewport（mobile）时，做的对应 Link 的 preload as fetch。</p><p>8、避免序列化的渲染。比如一个应用有 Nav 导航 + 主内容，是应该先出导航再出主内容，还是应该导航和主内容都好了之后一起出？作者觉得应该是后者，实现方法是通过调整 Suspense 元素的位置。这一点其实我是有疑问的，我觉得前一种渲染方式也挺好，避免长时间的白屏。</p><p>9、Transition 切换页面（依赖 React 18）。当我们切换页面时，有两个选择。1）切过去，等 loading，渲染；2）等 loading，切过去+渲染。基于 React 18 的 useTransition 可以实现后者，代码如下。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useNavigate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">startTransition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">n</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">to</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>10、预加载异步页面。作者介绍了个方法，把 React.lazy 封一下，在 window load 事件之后延迟自动执行。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">lazyPrefetch</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token parameter">chunk</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;load&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chunk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">once</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">lazy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chunk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>11、Module Federation。</p><p><a href="https://github.com/theninthsky/client-side-rendering" target="_blank" rel="noopener noreferrer">https://github.com/theninthsky/client-side-rendering</a></p><p>📒 人手 10x 工程师</p><p>先看两种 10x 工程师。1）写 10x 代码的工程师，但这类工程师对于负责 Review 他代码的同学会很有挑战，2）能评估复杂问题，站在技术前沿，先人一步拿出优雅解决方案的工程师，这类工程师一个团队通常没有几个。</p><p>你可能会觉得这两种都比较遥远，别灰心，还有一种 10x 工程师。他关注开发体验（dx）和团队健康，关注小但有倍增效应的事。比如添加缓存以加快持续集成，比如定期修复项目 setup 说明，比如增加 precommit 或加快自动化测试后让故障发生在本地而不是 CI 环境。这些变化随着时间推移所产生的累积效应，虽然不是你自己做了 10x 的工作，但通过提高一群工程师的生产力也能达到 10x 提效。</p><p><a href="https://typeofnan.dev/10x-engineering-for-the-rest-of-us/" target="_blank" rel="noopener noreferrer">https://typeofnan.dev/10x-engineering-for-the-rest-of-us/</a></p><p>📒 开源相关</p><ul><li>Next.js 发布 12.3，Fast Refresh 支持 .env 和 tsconfig.json，检测到 ts 或 tsx 文件自动完成 TypeScript 配置、SWC Minifier Stable</li><li>Meta 开源 shumai，基于 Bun + Flashlight 的 JavaScript 机器学习库</li><li>module-federation/nextjs-mf，让 Next.js 支持 Module Federation，目前 CSR Only</li><li>gradejs/gradejs，GradeJS 无需源码即可分析生产阶段的 webpack 产物构成，包括潜在问题，依赖了哪些包，等等</li></ul><p>📒 <a href="https://mp.weixin.qq.com/s/rPDGgAlzNrTqZX74zzqDsA" target="_blank" rel="noopener noreferrer">Go语言爱好者周刊：第 159 期 — 这道题目有点意思</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/9月11日内容汇总">9月11日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-09-11T00:00:00.000Z" itemprop="datePublished">September 11, 2022</time> · <!-- -->28 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 CSS 如何实现文本换行</p><p>在开发的时候遇到一个问题，后端给的文本包含换行符 <code>/n</code>，前端如何实现换行展示。最开始以为只能通过富文本展示，但实际上 CSS 中有一个属性可以支持换行：</p><div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">white-space</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pre</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/white-space" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/CSS/white-space</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/QkDUQOx9w1HZIFyyvIzp-A" target="_blank" rel="noopener noreferrer">Go 生态：Prometheus的四种指标类型，我终于搞懂了</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/ShH-SWhTCQLYasoIHy3xWg" target="_blank" rel="noopener noreferrer">Go 语言创始人：复制亿点点代码比用别人轮子好！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/fNcsMQuO1z8nmIRuiC8VnQ" target="_blank" rel="noopener noreferrer">「Go工具箱」推荐一个实现进度条功能的工具：uiprogress</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/JVGttsilTXLThaonU6ME6A" target="_blank" rel="noopener noreferrer">给蚂蚁金服antv提个PR，以为是改个错别字，未曾想背后的原因竟如此复杂！</a></p><p>📒 前端相关文章汇总</p><p><a href="https://medium.com/@bytefer" target="_blank" rel="noopener noreferrer">https://medium.com/@bytefer</a></p><p><a href="https://medium.com/pixel-and-ink/a-peek-at-userequest-hook-ba960cbddbf8" target="_blank" rel="noopener noreferrer">https://medium.com/pixel-and-ink/a-peek-at-userequest-hook-ba960cbddbf8</a></p><p><a href="https://javascript.plainenglish.io/15-utility-types-that-every-typescript-developer-should-know-6cf121d4047c" target="_blank" rel="noopener noreferrer">https://javascript.plainenglish.io/15-utility-types-that-every-typescript-developer-should-know-6cf121d4047c</a></p><p><a href="https://blog.bitsrc.io/6-best-ways-to-create-a-new-react-application-57b17e5d331a" target="_blank" rel="noopener noreferrer">https://blog.bitsrc.io/6-best-ways-to-create-a-new-react-application-57b17e5d331a</a></p><p>📒 Golang 技术方案</p><p><a href="https://kms.netease.com/topics/topic/612/item/14727" target="_blank" rel="noopener noreferrer">https://kms.netease.com/topics/topic/612/item/14727</a></p><p><a href="https://kms.netease.com/article/27452#%E9%80%89%E5%9E%8B" target="_blank" rel="noopener noreferrer">https://kms.netease.com/article/27452#%E9%80%89%E5%9E%8B</a></p><p><a href="https://github.com/NetEase-Media/ngo" target="_blank" rel="noopener noreferrer">https://github.com/NetEase-Media/ngo</a></p><p>📒 依赖注入简介</p><blockquote><p><a href="https://blog.codeminer42.com/dependency-injection-in-js-ts-part-1/" target="_blank" rel="noopener noreferrer">https://blog.codeminer42.com/dependency-injection-in-js-ts-part-1/</a></p></blockquote><p>📒 JavaScript 模块中的默认导出很糟糕吗</p><blockquote><p><a href="https://www.lloydatkinson.net/posts/2022/default-exports-in-javascript-modules-are-terrible/" target="_blank" rel="noopener noreferrer">https://www.lloydatkinson.net/posts/2022/default-exports-in-javascript-modules-are-terrible/</a></p></blockquote><p>📒 VS Code 发布新版本</p><p>保持上下文的 &quot;粘性滚动&quot;不再是一个实验性功能。将与 TypeScript v4.8 一起发布。</p><blockquote><p><a href="https://code.visualstudio.com/updates/v1_71" target="_blank" rel="noopener noreferrer">https://code.visualstudio.com/updates/v1_71</a></p></blockquote><p>📒 使用 gRPC 构建安全 API</p><p>一个允许两个 Node 应用程序通过 HTTP/2 和基于协议缓冲区的 gRPC 机制进行通信的演练教程。</p><blockquote><p><a href="https://snyk.io/blog/building-a-secure-api-with-grpc/" target="_blank" rel="noopener noreferrer">https://snyk.io/blog/building-a-secure-api-with-grpc/</a></p></blockquote><p>📒 最小化依赖关系的四种方法</p><p>在接连不断的供应链事故（和漏洞），或者查看了 <code>node_modules</code> 文件夹的最终体积后，你可能会想要将依赖关系保持在最低限度。这篇文章介绍了一些方法。</p><blockquote><p><a href="https://blog.appsignal.com/2022/08/31/4-ways-to-minimize-your-dependencies-in-nodejs.html" target="_blank" rel="noopener noreferrer">https://blog.appsignal.com/2022/08/31/4-ways-to-minimize-your-dependencies-in-nodejs.html</a></p></blockquote><p>📒 安装并运行 <code>bin</code> 脚本</p><p>npm 包可以通过 package.json 的 <code>bin</code> 属性指定它们提供的 shell 脚本和可运行文件。Axel 深入研究了它的工作原理，并且提供了两种方式来安装提供此类脚本的软件包。</p><blockquote><p><a href="https://2ality.com/2022/08/installing-nodejs-bin-scripts.html" target="_blank" rel="noopener noreferrer">https://2ality.com/2022/08/installing-nodejs-bin-scripts.html</a></p></blockquote><p>📒 Create Rust App: 用一行命令开启现代 Rust + React Web 应用程序</p><p>如果你想用 Rust 构建应用程序的后端，那么该库提供了一种 CRA 式的体验。它使用 Vite 并且新增了 SQLite 支持。</p><blockquote><p><a href="https://github.com/Wulf/create-rust-app" target="_blank" rel="noopener noreferrer">https://github.com/Wulf/create-rust-app</a></p></blockquote><p>📒 何时使用 <code>useLayoutEffect</code> 而不是 <code>useEffect</code></p><p>你的 UI 渲染过程中有烦人的闪烁吗？可能是你错误使用了其中之一的 Hook : 这与 Hook 是在浏览器绘制之前还是之后触发有关。</p><blockquote><p><a href="https://javascript.plainenglish.io/react-hooks-when-to-use-uselayouteffect-instead-of-useeffect-3271a96d881a?gi=622ccbf807f3" target="_blank" rel="noopener noreferrer">https://javascript.plainenglish.io/react-hooks-when-to-use-uselayouteffect-instead-of-useeffect-3271a96d881a?gi=622ccbf807f3</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/b805ZIO7-IabjStlAs7Wow" target="_blank" rel="noopener noreferrer">美团二面：考我幻读，结果答的不好</a></p><p>📒 码住！Golang并发安全与引用传递总结</p><p>先看一个在Go中关于Map类型并发读写的经典例子：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> testMap  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> testMap</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">go</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      testMap</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">select</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上例子会引发一个Fatal error：</p><blockquote><p>fatal error: concurrent map read and map write</p></blockquote><p>产生这个错误的原因就是在Go中Map类型并不是并发安全的，出于安全的考虑，此时会引发一个致命错误以保证程序不出现数据的混乱。</p><p>Golang 如何检测 Map 并发异常？</p><p>对于查询操作，大致检查并发错误的流程如下：在查询前检查并发flag是否存在，如果存在就抛出异常。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flags</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">hashWriting </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">throw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;concurrent map read and map write&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>对于修改操作则如下：</p><ul><li>写入前检查一次标记位，通过后打上标记</li><li>写入完成再次检查标记位，通过后还原标记</li></ul><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//各类前置操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flags</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">amp</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">hashWriting </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//检查是否存在并发</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">throw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;concurrent map writes&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//赋值标记位</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flags </span><span class="token operator" style="color:#393A34">^=</span><span class="token plain"> hashWriting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//后续操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//完成修改后，再次检查标记位</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flags</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">hashWriting </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">throw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;concurrent map writes&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//还原标记位取消hashWriting标记</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flags </span><span class="token operator" style="color:#393A34">&amp;^=</span><span class="token plain"> hashWriting</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如何避免 Map 的并发问题？</p><p>go官方认为因为Map并发的问题在实际开发中并不常见，如果把Map原生设计成并发安全的会带来巨大的性能开销。因此需要使用额外方式来实现。</p><ol><li>自行使用锁和map来解决并发问题</li></ol><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> cocurrentMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RWMutex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> testMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">cocurrentMap</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">:</span><span class="token function" style="color:#d73a49">make</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//写</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Unlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//读</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RLock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  testMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">RUnlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>这个方法存在问题就是并发量巨大的时候，锁的竞争也会带来巨量消耗，性能一般</p></blockquote><ol start="2"><li>使用sync.Map</li></ol><p>sync.Map通过巧妙的设计来提高并发安全下Map的性能，其设计思路是通过空间换时间来实现的，同时维护2份数据，read&amp;dirty。read主要用来避免读写冲突。</p><p>其数据结构如下：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Map </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mu Mutex </span><span class="token comment" style="color:#999988;font-style:italic">//锁</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  read atomic</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Value </span><span class="token comment" style="color:#999988;font-style:italic">//readOnly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dirty </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">entry </span><span class="token comment" style="color:#999988;font-style:italic">//*entry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  misses </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> readOnly </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m       </span><span class="token keyword" style="color:#00009f">map</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  amended </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// true if the dirty map contains some key not in m.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> entry </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  p unsafe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Pointer </span><span class="token comment" style="color:#999988;font-style:italic">// *interface{}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用示例如下：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> m sync</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 写</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 读</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//遍历</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">//....</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//删除</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//读取或写入</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">LoadOrStore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;test&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这里对sync.Map的原理不做深入展开，只提几点特性：</p><ul><li>read和dirty是共享内存的，尽量减少冗余内存的开销</li><li>read是原子性的，可以并发读，写需要加锁</li><li>读的时候先read中取，如果没有则会尝试去dirty中读取（需要有标记位readOnly.amended配合）</li><li>dirty就是原生Map类型，需要配合各类锁读写</li><li>当read中miss次数等于dirty长度时，dirty会提升为read，并且清理已经删除的k-v（延迟更新，具体如何清理需要enrty中的p标记位配合）</li><li>双检查（在加锁后会再次对值检查一遍是否依然符合条件）</li><li>sync.Map适用于读多写少的场景</li><li>sync.Map没有提供获取长度size的方法，需要通过遍历来计算</li></ul><p>切片类型 Slice 是并发安全的吗</p><p>与Map一样，Slice也不是并发安全的。但是在切片中并不会引发panic，如果程序无意中对切片使用了并发读写，严重的话会导致获取的数据和之后存储的数据错乱，所以这里要格外小心，可以通过加锁来避免。</p><p>切片除了并发有问题外，还有几点注意：</p><ul><li>Go只会对基础值类型在传参中使用深拷贝，实际上对于Slice和Map类型，使用的是浅拷贝，Slice作为传参，其指向的内存地址依然是原数据</li><li>Slice扩容机制的影响：向Slice中添加元素超出容量的时候，我们知道会触发扩容机制，而扩容机制会创建一份新的【原数据】此时，它与浅拷贝获取到的变量是没有任何关联的</li></ul><p><a href="https://mp.weixin.qq.com/s/dZIcI_3b8N8a2_nzJ7fNOA" target="_blank" rel="noopener noreferrer">码住！Golang并发安全与引用传递总结</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/U6FjIdGZ3n13-pS2J7nvLQ" target="_blank" rel="noopener noreferrer">ES6你用过哪些惊艳的写法</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/rJN14WFRTKjhoy8oWPulWw" target="_blank" rel="noopener noreferrer">用代码画时序图！YYDS</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/VQsKA1nQ6leh60d_JXJg_g" target="_blank" rel="noopener noreferrer">面试官：mysql查询 limit 1000,10 和limit 10 速度一样快吗</a></p><p>📒 <a href="https://snyk.io/blog/best-practices-to-build-java-containers-with-docker/" target="_blank" rel="noopener noreferrer">10 best practices to build a Java container with Docker</a></p><p>📒 <a href="https://linuxhandbook.com/create-systemd-services/" target="_blank" rel="noopener noreferrer">How to create a systemd service in Linux</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/r2_eSoM11nZPYp_1aNatBQ" target="_blank" rel="noopener noreferrer">Go 1.19.1 和 Go 1.18.6 终究还是来了</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/oVr9ojK6A8d8DIiIVdHwpQ" target="_blank" rel="noopener noreferrer">5分钟自建数据库可视化平台，在线管理数据库也太方便了！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/tVASa1trXkJR9nK_isTbmw" target="_blank" rel="noopener noreferrer">匿名 iframe：COEP 的福音！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/nzpJPMVs1JznYotZXb4tbQ" target="_blank" rel="noopener noreferrer">这些强大的 JS 操作符，你都知道吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/605zrHjHFsjJvRq7_xFP_Q" target="_blank" rel="noopener noreferrer">「Go工具箱」一个基于双向链表实现的LRU缓存工具</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/mNjLiEBnHIZhOTrDwNkmvA" target="_blank" rel="noopener noreferrer">这个 Go 开发的网络抓包工具，不仅好用还支持ES检索</a></p><p>📒 <a href="https://juejin.cn/post/7134583899597832200" target="_blank" rel="noopener noreferrer">一道简单又有意思的 JavaScript 手写题 — 异步加法 asyncAdd</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/naGheZq_z5d8pyB_i9hY7g" target="_blank" rel="noopener noreferrer">高并发下的网络 IO 模型设计</a></p><p>📒 <a href="https://juejin.cn/post/7096047543447978014" target="_blank" rel="noopener noreferrer">qiankun微前端改造实战（架构设计+代码实现）-超级详细vue代码干货篇！（伸手党福利）</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/FE8WgfINZ0hSWldkXVGo9g" target="_blank" rel="noopener noreferrer">Go语言中常见100问题-#8 any says nothing</a></p><p>📒 <a href="https://juejin.cn/post/7140549209735823373" target="_blank" rel="noopener noreferrer">读 Node.js 源码深入理解 cjs 模块系统</a></p><p>📒 当 React Query 遇见 React Router</p><p>React Router 6.4 即将正式发布，React Router 也加入了远程状态管理的数据获取游戏。本文将带你了解 React Router 和现有的远程状态管理库(如：React Query)之间的竞争和关联，作者认为他们是天造地设的一对。</p><p><a href="https://beta.reactrouter.com/en/dev" target="_blank" rel="noopener noreferrer">https://beta.reactrouter.com/en/dev</a></p><p><a href="https://tkdodo.eu/blog/react-query-meets-react-router" target="_blank" rel="noopener noreferrer">https://tkdodo.eu/blog/react-query-meets-react-router</a></p><p>隔壁家 Vue Router 的数据获取相关提案 Vue Router Data Loaders。</p><p><a href="https://github.com/vuejs/rfcs/discussions/460" target="_blank" rel="noopener noreferrer">https://github.com/vuejs/rfcs/discussions/460</a></p><p>📒 重新思考流行的 Node.js 模式和工具</p><p>Node.js 最佳实践、JavaScript 和 Node.js 测试最佳实践 的作者 Yoni Goldberg 对 Node.js 中的流行工具发出了灵魂拷问，并给出了他的思考：</p><ul><li><code>Node-convict</code> 比 <code>Dotenv</code> 更好；</li><li>从 Controller 调用 Service 时，要尽量抽象 Service 的内容(多用心封装封装)，尽可能屏蔽掉技术细节和复杂性，让看你代码的同学赏心悦目一些；</li><li>Nest.js 中万物皆可依赖注入，但简单点也许世界会更美好；</li><li>不一定要用 <code>Passport.js</code>；</li><li><code>SuperTest</code> 的三合一语法有时候并没有那么好用；</li><li><code>Fastify</code> 装饰器错误姿势</li><li>catch 子句的正确姿势；</li><li>避免重复使用日志工具 <code>Morgan</code>；</li><li>减少使用 process.env.NODE_ENV 当作判断条件。</li></ul><p><a href="https://practica.dev/blog/popular-nodejs-pattern-and-tools-to-reconsider/" target="_blank" rel="noopener noreferrer">https://practica.dev/blog/popular-nodejs-pattern-and-tools-to-reconsider/</a></p><p>📒 8 月登陆网络平台的新内容</p><p>Firefox 104、Chrome 104、Chrome 105 发布稳定版本。</p><ul><li>Chrome 104 新增 <strong>CSS transform 属性单独定义</strong></li><li>Chrome 104 新增 <strong>媒体查询的新语法</strong>，支持比较运算符，更加符合人体工程学</li><li>Chrome 105 新增 <strong>容器查询和 :has()</strong>，响应式的最佳拍档</li><li>Chrome 105 新增 <strong>Sanitizer API</strong>，防止 XSS 攻击的灭菌武器</li><li>Chrome 105 新增 <strong>:modal 伪类</strong></li><li>Firefox 104 支持 <strong>The findLast() 和 findLastIndex()</strong></li></ul><p><a href="https://web.dev/web-platform-08-2022/" target="_blank" rel="noopener noreferrer">https://web.dev/web-platform-08-2022/</a></p><p>📒 pnpm v7.10.0</p><p>Time-based 依赖解析模式</p><ol><li>直接依赖将安装其最低版本，比如 foo@^1.1.0，将会安装 1.1.0</li><li>间接依赖只会安装被选中的直接依赖在其发布时间点之前的版本</li></ol><p>据作者说，这种模式是为了减少供应链攻击导致项目“噶”的风险，因为它能保证间接依赖不会比直接依赖更加新。这样如果间接依赖被攻击，也不会安装被攻击的版本。不过这种解析模式需要拿到 npm 的完整元数据，所以速度会很慢。解法是自建 Verdaccio，并将 registry-supports-time-field 设置为 true。</p><p>能减少供应链攻击的风险是好事，但是感觉这种模式本身存在很多问题，比如不遵守 semver 语义，虽然社区里很多项目都没有好好遵守 :)、或者当旧的间接依赖修复了某个 bug，但是有 bug 的版本还是会被安装。</p><p><a href="https://github.com/pnpm/pnpm/releases/tag/v7.10.0" target="_blank" rel="noopener noreferrer">https://github.com/pnpm/pnpm/releases/tag/v7.10.0</a></p><p>📒 <a href="https://juejin.cn/post/7140216695834017822" target="_blank" rel="noopener noreferrer">前端食堂技术周刊第 51 期：pnpm v7.10.0、8 月登陆网络平台的新内容、重新思考流行的 Node.js 模式和工具、打包 JavaScript 库的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/1tUkWA1Df6k1lX8q5PW17g" target="_blank" rel="noopener noreferrer">从Vuex到Pinia</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/-PGp9meVMBGlkss7dXqDXA" target="_blank" rel="noopener noreferrer">程序员有很厉害，不外传的代码吗？可以运行，但不能动的那种！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/NjX2be78BlHrXF5hlKlA8A" target="_blank" rel="noopener noreferrer">你想知道的前后端协作规范都在这了</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/hZiRxXUrQwWEwT9JBkllTg" target="_blank" rel="noopener noreferrer">1.3w字，一文详解死锁！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/rAwplRSzwZne_KaCAJ2omA" target="_blank" rel="noopener noreferrer">【第2724期】前后端数据接口协作提效实践</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Rn4QjAmi581R0WkDxyTLjQ" target="_blank" rel="noopener noreferrer">去字节面试，直接让人出门左拐：Bean 生命周期都不知道！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/q7xK94mOphCO9PWVhsBIQQ" target="_blank" rel="noopener noreferrer">聊聊数据库建表的15个小技巧</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/nDg3NGAoeLdHkm54kb5bWw" target="_blank" rel="noopener noreferrer">如何优化你的 Node.js API</a></p><p>📒 <a href="https://juejin.cn/post/7139768397423706126" target="_blank" rel="noopener noreferrer">金九银十Go面试题进阶知识点：select和channel</a></p><p>📒 禁用 Cookie 后会怎样</p><p>会报错！解法很简单也很粗暴，就是加 try…catch。</p><p><a href="https://blog.tomayac.com/2022/08/30/things-not-available-when-someone-blocks-all-cookies/" target="_blank" rel="noopener noreferrer">https://blog.tomayac.com/2022/08/30/things-not-available-when-someone-blocks-all-cookies/</a></p><p>📒 现代 JS 库打包</p><p>这是一篇关于如何打包 JavaScript 库的现代化指南，介绍了维护 JavaScript 库的一些基础知识和最佳实践，推荐作为入门阅读。</p><p><a href="https://github.com/frehner/modern-guide-to-packaging-js-library" target="_blank" rel="noopener noreferrer">https://github.com/frehner/modern-guide-to-packaging-js-library</a></p><p>📒 Error Boundary 指南</p><p>虽然理想情况下是在生产之前捕获错误，但有些错误是会躲过测试的，比如网络错误，而如果没有正确处理，这些错误会导致 React 声明周期崩溃，导致白屏，并最终影响你的用户。正确的方式是提供适当的视觉反馈和潜在的行动指引（例如：重试机制）来优雅的处理这些错误。</p><p>你可能会有几个疑问。1）为啥会白屏？因为从 React 16 开始，没有被捕获的错误将导致整个 React 组件树的卸载。2）为啥 try.catch 不行？因为 React Hooks 执行是异步的，捕获不了。</p><p>解法当然就是用 React 官方提供的 Error Boundary 了，通过 Error Boundary 把组件包起来，可以想象成是包了一层 try…catch，组件报错会到此为止，不会再往上报。一个简单的 ErrorBoundary 如下。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ErrorBoundarySimple</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">componentDidCatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter literal-property property" style="color:#36acaa">error</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> unknown</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// report the error to your favorite Error Tracking tool (ex: Sentry, Bugsnag)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getDerivedStateFromError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter literal-property property" style="color:#36acaa">error</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> unknown</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Update state so the next render will show the fallback UI.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">hasError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hasError</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Failed</span><span class="token plain"> to fetch users</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">p</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">children</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但是官方的 Error Boundary 其实有缺陷，他不支持以下场景的报错，包括 Event handlers、异步代码比如 setTimeout 或 requestAnimationFrame 回调、SSR、Error Boundary 自己抛的错。同时，我们可能还需要提供重试机制等行动指南。解法是用 react-error-boundary 这个库。</p><p>react-error-boundary 如何支持重试？他提供的 ErrorBoundary 组件可以配置 FallbackComponent 组件，而这个组件有 error 和 resetErrorBoundary 两个 props，后者用于重试。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">ErrorBoundary</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react-error-boundary&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ErrorFallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> resetErrorBoundary </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pre</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pre</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">resetErrorBoundary</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">retry</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">App</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">ErrorBoundary</span><span class="token plain"> </span><span class="token maybe-class-name">FallbackComponent</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token maybe-class-name">ErrorFallback</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Users</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">ErrorBoundary</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>react-error-boundary 如何捕获 React 生命周期外的错误？比如 Event Handler 和异步代码。react-error-boundary 提供 useErrorHander hook，他会返回处理错误的函数。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> useErrorHandler </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react-error-boundary&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">App</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> handleError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useErrorHandler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleSubmit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xxx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handleError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// do render</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://meticulous.ai/blog/react-error-boundaries-complete-guide/" target="_blank" rel="noopener noreferrer">https://meticulous.ai/blog/react-error-boundaries-complete-guide/</a></p><p>📒 10 个 React 新手陷阱</p><p>React 是 unopinionated 的，同样的问题会存在许多不同的解法，这给开发者留下了大量的空间来用自己愚蠢的想法把事情搞砸。在今天的文章中，我们将看看 React 中的 10 个陷阱（反模式），以及改进我们代码的技巧和窍门，同时也可以为前端技术面试做准备。</p><p>1、巨型组件。就是一个组件内很大，通常是因为不知道如何组织代码，或者不想把时间浪费在组织代码上。这样的组件很难理解、重构和测试。通过 WebStorm 的「Refactor - Move」或者 VSCode 的 Glean 插件快速提速代码到文件，可以节省你不少时间。</p><p>2、嵌套陷阱。不要在组件内定义子组件，比如 <code>function Parent() { const Child = () =&gt; &lt;div&gt;Child&lt;/div&gt;; return &lt;&gt;&lt;Child /&gt;&lt;/&gt; }</code>，解法是把 Child 定义提到外面。</p><p>3、没有用 useMemo/useCallback。遇到重计算的点，每次 re-render 会重新执行导致性能消耗严重，比如 <code>const total = expensiveCal(count)</code>。解法是用 useMemo 避免重复计算，比如 <code>const total = useMemo(() =&gt; expensiveCal(count), [count])</code>。如果遇到函数，记得切换到 useCallback。</p><p>4、无意义的 div 元素。React 组件只能由一个根组件，当需要渲染多个相邻的元素时，你可能会引入 div 元素。但这不是必要的，不必要的 div 元素可能导致可访问性和 CSS 样式问题。更好的做法是用 Fragment 组件，比如 <code>&lt;&gt;&lt;Foo /&gt;&lt;Bar /&gt;&lt;/&gt;</code>。</p><p>5、混乱的文件。随着组件越来越多，在一个文件中导出多个组件是「诱人」的。但是这样，也会很快让事情变得复杂。更好的做法是有一套自己的文件组织规范，比如一个组件一个文件，或者一个组件一个文件夹，同时在文件夹下可能还会有自己的测试文件等。</p><p>6、巨大的 Bundle 产物。大型复杂应用的最大问题之一就是产物很大，这会让页面加载变慢，因为浏览器需要很长时间来下载、解析和执行 JavaScript Bundle 产物。解法是应用内置了 code splitting 功能的框架，或者使用 Suepense + React.lazy + import()。</p><p>7、Prop Drilling。当上层组件中持有 state，而一个深度嵌套的组件需要使用这个 state 时，一种做法是用 props 透过中间组件一层层往下传，而实际上中间组件并不需要他们，这就是 Prop Drilling。解法是用 Redux 或其他数据流工具，或者使用 Context。</p><p>剩下 3 个是 Prop Plowing、Try Some Curry 和 Code Smarter，感觉不太重要，是为了凑 10 个加的，我就不介绍了，有兴趣的可以查看原文。</p><p><a href="https://medium.com/@imranfarooq0306/10-react-traps-to-avoid-as-react-developer-5570808e346b" target="_blank" rel="noopener noreferrer">https://medium.com/@imranfarooq0306/10-react-traps-to-avoid-as-react-developer-5570808e346b</a></p><p>📒 useMemo + useCallback</p><p>这是一篇很好的 useMemo 和 useCallback 入门文章，但没有引入啥新知识，我就不展开了。</p><p><a href="https://www.joshwcomeau.com/react/usememo-and-usecallback/" target="_blank" rel="noopener noreferrer">https://www.joshwcomeau.com/react/usememo-and-usecallback/</a></p><p>📒 React 18 SSR 流式渲染</p><p>React 18 SSR 流式渲染可基于 Suspense + Lazy、renderToPipeableStream 和 hydrateRoot 实现。Suspense + Lazy 在客户端用于代码拆分和懒加载，在服务端则用于流式渲染，renderToPipeableStream 用于流式返回数据，hydrateRoot 用于在流式返回后就开始注水而无需等到全部内容都返回。</p><p>以上完成了流式渲染，但还有个问题需要解，即「数据怎么获得」？并且需要同时考虑服务端和客户端。作者给的解是还处于实验阶段的 Data Fetching API。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> resource </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fetchProfileData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Posts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> posts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> resource</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">posts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// render with posts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>目前要支持 Data Fetching API，可将 Promise 包装成 Data Fetching API。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wrapPromise</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pending&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> suspensder </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">r</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;pending&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> suspensder</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Suspense 识别 Data Fetching 的 loading 状态是基于 read 方法的返回值。如果 throw promise 即还在 loading，如果 throw error 则出错，如果返回数据则完成 loading。</p><p><a href="https://juejin.cn/post/7137976587047141407" target="_blank" rel="noopener noreferrer">在 React 18 下，如何实现产品级的 SSR 和流式渲染</a></p><p>📒 开源推荐</p><p><strong>1. clean-pkg-json</strong></p><p>NPM 发包时不需要的 package.json 字段</p><p><a href="https://github.com/privatenumber/clean-pkg-json" target="_blank" rel="noopener noreferrer">https://github.com/privatenumber/clean-pkg-json</a></p><p><strong>2. ts-prune</strong></p><p>用于找到 TypeScript 项目未使用的 export 信息，消除 dead code</p><p><a href="https://github.com/nadeesha/ts-prune" target="_blank" rel="noopener noreferrer">https://github.com/nadeesha/ts-prune</a></p><p><strong>3. module-federation/typescript</strong></p><p>Typescript Types Support For Module Federation</p><p><a href="https://github.com/module-federation/typescript" target="_blank" rel="noopener noreferrer">https://github.com/module-federation/typescript</a></p><p><strong>4. React Router 6.4 将于下周发布</strong></p><p>📒 Go 眼中的文件系统是什么？ io.FS</p><p>Go 理解的文件系统，只要能实现一个 Open 方法，返回一个 File 的 interface ，这个 File 只需要实现 Stat，Read，Close 方法即可。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 文件系统的接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> FS </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">File</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 文件的接口</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> File </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Stat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FileInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>有没有发现，OS 的 FS 已经满足了条件。所以，Go 的 FS 可以是 OS 的 FS ，自然也可以是其他的实现。</p><p>Go 在此 io.FS 的基础上，再去扩展接口，增加文件系统的功能。比如，加个 ReadDir 就是一个有读目录的文件系统 ReadDirFS ：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> ReadDirFS </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 读目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ReadDir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">DirEntry</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>以上是 Golang 接口继承的写法，<code>ReadDirFS</code> 接口继承了 <code>FS</code> 接口，同时扩展了 <code>ReadDir</code> 方法。注意，Golang 是不支持面向对象的。</p></div></div><p>加个 Glob 方法，就成为一个具备路径通配符查询的文件系统：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> GlobFS </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 路径通配符的功能</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Glob</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pattern </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>加个 Stat ，就变成一个路径查询的文件系统：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> StatFS </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 查询某个路径的文件信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Stat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">FileInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这些非常经典的文件系统的定义 Go 在 io/fs 里面已经做好了。</p><p>我们的目标是实现一个 Go 的 FS ，这个定义已经在 io.FS 有了。我们只需要写一个结构体，实现它的方法，那么你就可以说这是一个 FS 了。</p><p>这里其实就可以有非常多的想象空间，比如，可以是 OS 的 FS，也可以是 memory FS ，hash FS 等等。网上有不少例子。但其实标准库已经有一个最好的例子，那就是 embed FS 。</p><p>我们来看下 embed 怎么实现一个内嵌的文件系统。embed 的实现在 embed/embed.go 这个文件中，非常精简。</p><p>首先，在 embed package 里定义了一个结构体 FS ，这个结构体将是 io.FS 的具体实现。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 作为具体 FS 的实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> FS </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  files </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 代表一个内嵌文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> file </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name </span><span class="token builtin">string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data </span><span class="token builtin">string</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 文件的数据全在内存里</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hash </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// truncated SHA256 hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>embed 里面的 FS 结构体只需要实现 Open 这个方法即可：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Open 的具体实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f FS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">File</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 通过名字匹配查找到 file 对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  file </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">lookup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 如果没找到</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> file </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PathError</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Op</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;open&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Err</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ErrNotExist</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 如果是目录结构</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">IsDir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">openDir</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">readDir</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 找到了就封装成 openFile 结构体</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">openFile</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>上面的 Open ，如果是文件的化，返回的是一个 openFile 的结构体 ，作为 io.File 接口的具体实现：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 代表一个文件的实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> openFile </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  f </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">file </span><span class="token comment" style="color:#999988;font-style:italic">// the file itself</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  offset </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// current read offset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">openFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain">               </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">openFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Stat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FileInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">openFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 判断偏移是否符合预期</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">int64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PathError</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Op</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Err</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ErrInvalid</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 从内存拷贝数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  n </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">offset </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">int64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如上，只需要实现 Read，Stat，Close 方法即可。这就是一个完整的、Go 层面的 FS 的实现。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Go 的 FS 封装有啥用呢</p><ul><li>单测方便了，可以直接对应用进行测试，不必依赖底层实现</li><li>封装出一个 io.FS 的抽象，意图和 OS 的 FS 解耦，类似 embed FS 这种非 OS 文件系统的需求，可以有方法扩展了</li></ul></div></div><p><a href="https://mp.weixin.qq.com/s/bZO6kfhfdMaOkYZuGjOl_Q" target="_blank" rel="noopener noreferrer">Go 眼中的文件系统是什么？ io.FS</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/5CFjXV8dI_Pczl5g2z95jA" target="_blank" rel="noopener noreferrer">对 Go2 错误处理提案的批判</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/n2zLsJun0go4dR3g1Pi84Q" target="_blank" rel="noopener noreferrer">微服务配置中心， 这个方案 Go 里用起来不输 SpringCloud</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/lo59WvtOoqdA87dn9DiraQ" target="_blank" rel="noopener noreferrer">Go语言爱好者周刊：第 158 期</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/9月4日内容汇总">9月4日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-09-04T00:00:00.000Z" itemprop="datePublished">September 4, 2022</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://mp.weixin.qq.com/s/o41_hJE6Sa67b3GtK3ogIA" target="_blank" rel="noopener noreferrer">Resize Observer 介绍及原理浅析</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/kiLgCwfbak6CXHJWxomSeA" target="_blank" rel="noopener noreferrer">【第2722期】腾讯医药微信小程序性能优化：从0.9秒到0.5秒</a></p><p>📒 <a href="https://juejin.cn/post/7138781839720153096" target="_blank" rel="noopener noreferrer">深入理解 Mocha 测试框架：从零实现一个 Mocha</a></p><p>📒 <a href="https://juejin.cn/post/7128369638794231839" target="_blank" rel="noopener noreferrer">React 官网为什么那么快</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/xjY0d8eNTmAuCZKxKQeu7g" target="_blank" rel="noopener noreferrer">基于storybook组件库的技术选型该怎么选</a></p><p>📒 图解 Node.js 的核心 event-loop</p><p>我们平时说 Node.js 是单线程仅仅是指 node 执行我们的 JS 代码，更准确地说是 V8 执行 JS code 是发生在单线程里面的。实际上如果你打开 Node 进程，会发现它有不少 worker thread。这是一个典型的单进程多线程模型。这些 worker thread 被放置于线程池里面，而 V8 执行 JS code 的线程被称为主线程。</p><p><a href="https://mp.weixin.qq.com/s/kz9ahljqVnJ7m6PExULs6A" target="_blank" rel="noopener noreferrer">图解 Node.js 的核心 event-loop</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/xAi8IuD1GrfS7qiJqQqM3Q" target="_blank" rel="noopener noreferrer">手把手教你手写 Vite Server（二）—— 插件架构设计</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/SLy0e1HnEcMFlB__jRuu3A" target="_blank" rel="noopener noreferrer">为什么 Vue3 的 VNode 不能单独组成一棵完整的树</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/LJ4zVn31UeM7Z1ouN67t8A" target="_blank" rel="noopener noreferrer">深度解读 Vite 的依赖扫描</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/HzT6G9x6fb4hPZqkBvTIew" target="_blank" rel="noopener noreferrer">浅谈MyBatis批量插入的3种方法，10w条数据使用foreach仅需2秒！！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/zLNwq32UKaCsaAXn2BaZkw" target="_blank" rel="noopener noreferrer">「Go工具箱」重磅推荐：一个国产的，star高达12k+的操作excel的包：Excelize</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/zT4d2snbG8td8fg9Gt--ig" target="_blank" rel="noopener noreferrer">拒绝 Go 代码臃肿，其实在这几块可以用下观察者模式</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/3VrteSGHNKO5qRjNYTuj5g" target="_blank" rel="noopener noreferrer">几个非常有意思的javascript知识点总结</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/nDnQuZn3hVgrwqWVada2cw" target="_blank" rel="noopener noreferrer">AI数字绘画 stable-diffusion 保姆级教程</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Ucqqg4h9uRo7RVd8XCz80w" target="_blank" rel="noopener noreferrer">Go 的零值有什么用？看看这 4 个场景</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/5TfAoS6nuFalfZuQ2Fv3_w" target="_blank" rel="noopener noreferrer">对前端架构的理解 - 分层与抽象</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/uAh_9gIth2HNS67y2z8pew" target="_blank" rel="noopener noreferrer">【第2719期】如何使用 HTTPS 进行本地开发</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/xDXwsVjOfU2j3gisiHTZTQ" target="_blank" rel="noopener noreferrer">Go 适合 IO 密集型？并不准确！</a></p><p>📒 <a href="https://dev.to/lubomirblazekcz/announcing-vituum-template-engines-and-more-in-vite-377k" target="_blank" rel="noopener noreferrer">Announcing Vituum - Template engines and more in Vite</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Y3NGQH3hrT85O7aN7IrCIQ" target="_blank" rel="noopener noreferrer">「Go工具箱」一个让终端内容彩色化的工具：Color</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/fzmN6zFVioQGedTdSDmyqQ" target="_blank" rel="noopener noreferrer">如何让 Go 反射变快</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/DG48sC4b42TEpHLNnFtlhw" target="_blank" rel="noopener noreferrer">MySQL 单表最大两千万？我不信</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/12BS4V6fvXkeb84XDpPnHw" target="_blank" rel="noopener noreferrer">了解微前端，深入前端架构的前世今生</a></p><p>📒 <a href="https://oscarotero.com/deno/" target="_blank" rel="noopener noreferrer">Deno cheat sheet</a></p><p>🌛 <a href="https://github.com/TheAlgorithms/Rust" target="_blank" rel="noopener noreferrer">用 Rust 实现的数据结构与算法合辑</a></p><p>📒 使用 React 18 和 Suspense 改善 INP（Interaction to Next Paint）指标</p><blockquote><p><a href="https://vercel.com/blog/improving-interaction-to-next-paint-with-react-18-and-suspense" target="_blank" rel="noopener noreferrer">https://vercel.com/blog/improving-interaction-to-next-paint-with-react-18-and-suspense</a></p></blockquote><p>📒 7 种创建新 React 应用的最佳方式</p><p>Create React App 可能是最有名的，但还有其他一些方法值得考虑，包括更大的框架（如 Next.js）或构建系统（如 NX）。</p><blockquote><p><a href="https://blog.bitsrc.io/6-best-ways-to-create-a-new-react-application-57b17e5d331a?gi=dc52c656ac21" target="_blank" rel="noopener noreferrer">https://blog.bitsrc.io/6-best-ways-to-create-a-new-react-application-57b17e5d331a?gi=dc52c656ac21</a></p></blockquote><p>📒 Advanced React component composition</p><blockquote><p><a href="https://frontendmastery.com/posts/advanced-react-component-composition-guide/" target="_blank" rel="noopener noreferrer">https://frontendmastery.com/posts/advanced-react-component-composition-guide/</a></p></blockquote><p>📒 Why React Re-Renders</p><p>如果你想要使 React 应用获得最好的性能，那么理解和正确处理渲染过程是非常重要的。有很多关于如何使 React 渲染更高效的文章，但这篇文章深入探讨了为什么 React 能够以一种可访问的、容易遵循的方式进行渲染。</p><blockquote><p><a href="https://www.joshwcomeau.com/react/why-react-re-renders/" target="_blank" rel="noopener noreferrer">https://www.joshwcomeau.com/react/why-react-re-renders/</a></p></blockquote><p><code>why-did-you-render</code> 是一个经典的工具，用于进一步深入这个问题。</p><blockquote><p><a href="https://github.com/welldone-software/why-did-you-render" target="_blank" rel="noopener noreferrer">https://github.com/welldone-software/why-did-you-render</a></p></blockquote><p>⭐️ <a href="https://mp.weixin.qq.com/s/MlC6-TDf06LGpF8hxcSV_w" target="_blank" rel="noopener noreferrer">工厂模式有三个Level，你能用Go写到第几层</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/tu5bBNn3UJ5r3Z7K5eqwJw" target="_blank" rel="noopener noreferrer">TypeScript 4.8 发布！重点新特性解读</a></p><p>📒 React + TypeScript 最小知识集</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">HTMLAttributes</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">PropsWithChildren</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">HelloProps</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">HTMLAttributes</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name">HTMLDivElement</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Hello</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FC</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">PropsWithChildren</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">HelloProps</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  children</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">rest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag spread punctuation" style="color:#393A34">{</span><span class="token tag spread operator" style="color:#393A34">...</span><span class="token tag spread" style="color:#00009f">rest</span><span class="token tag spread punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">Hello, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">!</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>React.FC</code> 表示 Function Component 函数式组件</li><li><code>PropsWithChildren</code> 让 <code>props.children</code> 带类型</li><li><code>HTMLAttributes&lt;HTMLDivElement&gt;</code> 让 <code>props</code> 可以使用 html 属性比如 <code>className</code></li></ul><p><a href="https://ente.io/blog/tech/typescript-for-react/" target="_blank" rel="noopener noreferrer">https://ente.io/blog/tech/typescript-for-react/</a></p><p>📒 Tauri vs. Electron</p><p>作者分别用 Tauri 和 Electron 实现了 Authme，然后从打包、启动时间、性能、后端、应用渲染、安全、自动更新、开发体验共 8 个维度进行了对比。</p><p>1、「打包」Tauri 完胜。1）尺寸上 Tauri 2.5M vs. Electron 85M，2）Tauri 的产物是二进制的，反编译解码逻辑所需成本相比 Electron 会高很多。
2、「启动时间」Tauri 胜。Tauri 2s vs. Electron 4s。
3、「性能」Tauri 完胜。
4、「后端」Electron 胜。因为 Electron 后端基于 Node，而 Tauri 基于 Rust。当然如果你会 Rust 则是另一回事。另外，Tauri 的 Roadmap 里有支持其他后端绑定的计划，比如 Deno，届时就又可以用 JavaScript/TypeScript 写后端了。
5、「应用渲染」Electron 胜。Electron 使用 Chromium，所以你的用户在 Windows、Linux 和 macOS 上看到的东西是一样的。Tauri 使用系统的 WebView，Windows 上使用 Edge Webview2（Chromium），Linux 上使用 WebKitGTK，macOS 上使用 WebKit。这里的问题是 Webkit 的支持总是落后一点，所以你可能会需要额外的补丁。
6、「安全」Tauri 胜。Tauri 内置大量安全功能，可以明确启用或禁用某些 API。Electron 中则可以完全访问 Node 的 API，所以相比来说更容易被黑客利用。
7、「自动更新」Electron 胜。Tauri 和 Electron 都内置了自动更新器，而 Tauri 的相对简单，同时需要维护依赖并手动更新 JSON，而 Electron 可基于 electron-updater 并直接从 Github 发布的二进制文件中提取，要方便很多。
8、「开发体验」Tauri 胜。基于 Tauri CLI 就会包含热重载、为所有平台构建你的应用程序、生成应用程序图标等全部功能，而 Electron 啥都没有提供，只有框架本身。</p><p><a href="https://www.levminer.com/blog/tauri-vs-electron" target="_blank" rel="noopener noreferrer">https://www.levminer.com/blog/tauri-vs-electron</a></p><p>📒 father 4 正式发布</p><p>father 4 的具备如下核心特性：</p><ul><li><strong>双模式构建</strong>： 支持 Bundless 及 Bundle 两种构建模式，ESModule 及 CommonJS 产物使用 Bundless 模式，UMD 产物使用 Bundle 模式</li><li><strong>多构建核心</strong>： Bundle 模式使用 Webpack 作为构建核心，Bundless 模式使用 esbuild 及 Babel 两种构建核心，可通过配置自由切换</li><li><strong>类型生成</strong>： 无论是源码构建还是依赖预打包，都支持为 TypeScript 模块生成 .d.ts 类型定义</li><li><strong>项目体检</strong>： 对 NPM 包研发常见误区做检查，让每一次发布都更加稳健</li><li><strong>微生成器</strong>： 为项目追加生成常见的工程化能力，例如使用 jest 编写测试</li><li><strong>依赖预打包</strong>： 开箱即用的依赖预打包能力，帮助 Node.js 框架/库提升稳定性、不受上游依赖更新影响（实验性）</li></ul><p>📒 <a href="https://mp.weixin.qq.com/s/Zb5zGOy_mdalUQ_Qy0HngQ" target="_blank" rel="noopener noreferrer">3种方式！Go Error处理最佳实践</a></p><p>📒 <a href="https://juejin.cn/post/7121244973558661150" target="_blank" rel="noopener noreferrer">超大体量项目，微前端落地方案，看完后悔来找我</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/mxGv7IdQ_KcYqja5ffhmcQ" target="_blank" rel="noopener noreferrer">快速搭建 SpringCloud Alibaba Nacos 配置中心！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/xqhMG-bB71MoIQ9R_I48gw" target="_blank" rel="noopener noreferrer">k8s下微前端如何做金丝雀发布</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/8月28日内容汇总">8月28日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-28T00:00:00.000Z" itemprop="datePublished">August 28, 2022</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://mp.weixin.qq.com/s/JWks8VyuXoB5zaeYdyJPxw" target="_blank" rel="noopener noreferrer">【第2714期】从Multirepo到Monorepo 袋鼠云数栈前端研发效率提升探索之路</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/fjeF3LLoGsPIQN4D3el67g" target="_blank" rel="noopener noreferrer">抖音平台多产物代码隔离技术的实践与探索</a></p><p>📒 <a href="https://juejin.cn/post/7123961170188304391" target="_blank" rel="noopener noreferrer">Hooks时代，如何写出高质量的react和vue组件</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/IGaUcYDIb4e3zGGi9jvdig" target="_blank" rel="noopener noreferrer">Vite 约定式路由的最佳实践</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/2VGeRphTiS2XXUiBnhvvcA" target="_blank" rel="noopener noreferrer">Go使用泛型后，这么写单元测试会失效</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/mO819q_r9qLVuRBE8cjx1Q" target="_blank" rel="noopener noreferrer">如何保证数据库和缓存双写一致性</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/fymuGPW-9agEtxYX2s4FPQ" target="_blank" rel="noopener noreferrer">【第2713期】工程化思维：主题切换架构</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Cq-CF1BC4PWwGnlRp4HrnQ" target="_blank" rel="noopener noreferrer">为了拿捏 Redis 数据结构，我画了 40 张图（完整版）</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/XmsSgGop7TT_RQvXyp1kGA" target="_blank" rel="noopener noreferrer">美团一面：如何在 100 亿数据中找到中位数</a></p><p>📒 解决老工程 toast 组件问题</p><p>老工程 React 15.x，Webpack 2.x，工程里面原先没有组件库。</p><p>关于 npm 包可能存在部分 ES6 语法，低版本 Webpack 无法解析问题，可以用 Babel 转一下。同理 NPM 包使用了 ES Module 模块语法，也可以用 Babel 转为 CommonJS。现在主要的问题是，大多数 toast 组件，底层都用了 React Hooks，即使 ES 语法兼容，但是运行环境 React 版本太老还是无法兼容。最终还是选用 rc-notification，参考 antd 封装：</p><p><a href="https://github.com/react-component/notification/tree/2.0.6" target="_blank" rel="noopener noreferrer">https://github.com/react-component/notification/tree/2.0.6</a></p><p><a href="https://github.com/ant-design/ant-design/blob/2.13.14/components/message/index.tsx" target="_blank" rel="noopener noreferrer">https://github.com/ant-design/ant-design/blob/2.13.14/components/message/index.tsx</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Q0vxASPNiACd_gCl-rq-2Q" target="_blank" rel="noopener noreferrer">Kubernetes原理与架构初探</a></p><p>📒 VS Code 1.70 新特性</p><p><strong>3-way merge editor</strong></p><p>三路合并编辑器是在1.69版本里上线的，这个功能允许用户在VS Code内快速解决 Git 合并冲突。该功能启用后，可以通过点击「源代码控制视图」中的冲突文件来打开合并编辑器。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">settings.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;git.mergeEditor&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Git 提交辅助操作</strong></p><p>可以使用 <code>git.postCommitCommand</code> 来设置控制辅助操作，比如允许用户在提交信息后进行推送或者同步。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">settings.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;git.postCommitCommand&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sync&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>分支保护</strong></p><p>在之前的1.68版本中，VS Code就添加了 <code>git.branchProtection</code> 以用于配置受保护的特定分支。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">settings.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;git.branchProtection&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Command Center</strong></p><p>Command Center 功能启用后，其位于编辑器顶部的长条空间，让用户可以快速搜索项目中的文件。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">settings.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;window.commandCenter&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>sticky scroll</strong></p><p>当用户在编辑器中滚动鼠标查看代码时，每个子模块（比如：类/接口/命名空间/函数/方法等等）代码的第一行会置顶固定住，以方便查看。</p><p>这对于一些长代码模块（比如一个很长的函数）的阅读体验提升还是非常有帮助的。</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">settings.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;editor.experimental.stickyScroll.enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>📒 <a href="https://mp.weixin.qq.com/s/Mj_47WqUfIpcLF_-t38HYw" target="_blank" rel="noopener noreferrer">Java中的语法糖甜不甜？巧用枚举实现订单状态转换！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/EGN7G8ku-zkaZuzfBwx9Qw" target="_blank" rel="noopener noreferrer">看 Go 中的 struct 如何被优化，还有小插曲</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/7A6VCvuv8umUlOUzB2uHfA" target="_blank" rel="noopener noreferrer">Rust 与 Go 可以互操作</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/8Bc9k880DpwsaY9pJIowSA" target="_blank" rel="noopener noreferrer">SWC 入门介绍</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/DbTAUiBt4GE4whYe9S6Ifw" target="_blank" rel="noopener noreferrer">听说TCP能保证不丢包？图解TCP六大丢包场景</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Z29mNvpU6LVBBSS9FGZk_w" target="_blank" rel="noopener noreferrer">Vue3中defineEmits、defineProps 是怎么做到不用引入就能直接用的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/gaOzwCypQMFAJ4X50aUOcg" target="_blank" rel="noopener noreferrer">浅析神经网络 Neural Networks</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Qlqt1pP_Li-PxOICrz7bAw" target="_blank" rel="noopener noreferrer">在 Go 里用 CGO？这 7 个问题你要关注！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/La5qCJh5Vup_gZIgZMOo4g" target="_blank" rel="noopener noreferrer">分布式接口幂等性、分布式限流：Guava 、nginx和lua限流</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Am0ORd08GsMc4xSdLG9kgg" target="_blank" rel="noopener noreferrer">Go 探讨了 13 年，怎么解决再赋值的坑</a></p><p>📒 TypeScript Collections</p><p>用 TypeScript 编写的数据结构合集</p><p><a href="https://github.com/basarat/typescript-collections" target="_blank" rel="noopener noreferrer">https://github.com/basarat/typescript-collections</a></p><p>📒 Vite Rollup Plugins</p><p>Vite3 中使用 Rollup 插件的兼容性列表</p><p><a href="https://github.com/patak-dev/vite-rollup-plugins" target="_blank" rel="noopener noreferrer">https://github.com/patak-dev/vite-rollup-plugins</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/VFS4TWi3OpeAegScZ4cJRw" target="_blank" rel="noopener noreferrer">Go语言从0到1实现最简单的数据库！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/IRGAN0e9tbL5hwG4hx1kxQ" target="_blank" rel="noopener noreferrer">一文读懂TypeScript类型兼容性</a></p><p>📒 Communicating Effectively As A Tech Lead</p><p>Addy Osmani 的新作，从 Simplify、Be concise and on point、Communicating with executives、Listen、Be proactive、Be thorough 和 Take notes 7 个维度介绍作为 TL 时如何高效沟通。</p><p><a href="https://addyosmani.com/blog/communication-tech-lead/" target="_blank" rel="noopener noreferrer">https://addyosmani.com/blog/communication-tech-lead/</a></p><p>📒 React Re-Renders</p><p>通过这篇文章，我学到了「两个误解」、「一个比喻」和「一个技巧」。</p><p>两个误解是，1）state 变更会让整个 app re-render？不是，state 变更只会让当前组件及其子组件 re-render，2）组件 re-render 是因为 props 变更？也不是，props 往上可以追溯到 state 变更，是 state 变更导致了子组件 re-render，而不是由 props 变更引起。</p><p>上述误解 2 的一个例外是 React.memo，应用 React.memo 后的组件只有 props 变更才会触发 re-render。你可能会想：为什么这不是默认行为？因为作为开发者，我们往往高估了重新渲染的成本。对于 props 很多且没有很多子组件的组件来说，相比 re-render，检查 props 是否变更带来的消耗可能更大。因此，如果对每个组件都进行 React.memo，可能会产生反效果。</p><p>一个比喻是，每次渲染都是由照相机拍摄的快照，React 通过玩「找不同」的游戏找出两张照片之间的差异，然后决定是否 re-render。而 React.memo 则是懒惰的摄影师，如果你要求他为完全相同的东西拍 5 张照片，它会拍 1 张照片并给你 5 份。只有当你的指令改变时，他才会拍下一张新的照片。</p><p>一个技巧是，借助 React Devtools Chrome 插件，在「设置 &gt; Profiler」里开启「Record why each component rendered while profiling」，再通过录制的方式排查，就能知道每个 re-render 的原因。</p><p>原文链接：</p><p><a href="https://www.joshwcomeau.com/react/why-react-re-renders/" target="_blank" rel="noopener noreferrer">https://www.joshwcomeau.com/react/why-react-re-renders/</a></p><p>中文翻译：</p><p><a href="https://mp.weixin.qq.com/s/SH7N2f5ZhUhysQ7_G2s9rQ" target="_blank" rel="noopener noreferrer">【第2709期】一份详尽的 React re-render 指南</a></p><p>📒 深入解读新一代全栈框架 Fresh</p><p>从定位上来看，Fresh 属于 <strong>Web 全栈开发框架</strong>，相比 Next.js 和 Remix， Fresh 有哪些值得一提的亮点：</p><ul><li>Fresh 基于 Deno 运行时，由 Deno 原班人马开发，享有 Deno 一系列工具链和生态的优势，比如内置的测试工具、支持 http import 等等</li><li>渲染性能方面，Fresh 整体采用 Islands SSR 架构(之前介绍的 Astro 也是类似)，实现了客户端按需 Hydration，有一定的渲染性能优势</li><li>还有一个比较出色的点是构建层做到了 Bundle-less，即应用代码不需要打包即可直接部署上线</li><li>最后，不同于 Next.js 和 Remix，Fresh 的前端渲染层由 Preact 完成，包括 Islands 架构的实现也是基于 Preact，且不支持其它前端框架</li></ul><p>开发者并不需要手写路由文件，Fresh 可以自动地生成服务端的路由到文件的映射关系。很明显 Fresh 实现了 <strong>约定式路由</strong> 的功能，跟 Next.js 类似。</p><p><a href="https://mp.weixin.qq.com/s/8qNI4a-3P2KId9WRAnz2dw" target="_blank" rel="noopener noreferrer">深入解读新一代全栈框架 Fresh</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/8月21日内容汇总">8月21日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-21T00:00:00.000Z" itemprop="datePublished">August 21, 2022</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://juejin.cn/post/7133943494023839780" target="_blank" rel="noopener noreferrer">玩转 Chrome DevTools，定制自己的调试工具</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/ukZxF_W6dahisVW_Xf6-TA" target="_blank" rel="noopener noreferrer">【第2707期】由 esbuild JavaScript API 看跨语言调用</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Mmj6jJkuQMIf5SGEi_pBaQ" target="_blank" rel="noopener noreferrer">Go 中闭包的底层原理是</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/o_cXCroRSK5HAKG0wjC29Q" target="_blank" rel="noopener noreferrer">使用 TypeScript 编写 React 的最佳实践！</a></p><p>📒 Webpack 构建优化</p><p><a href="https://tsejx.github.io/webpack-guidebook/best-practice/optimization/collection" target="_blank" rel="noopener noreferrer">https://tsejx.github.io/webpack-guidebook/best-practice/optimization/collection</a></p><p><a href="https://webpack.js.org/guides/code-splitting/" target="_blank" rel="noopener noreferrer">https://webpack.js.org/guides/code-splitting/</a></p><p>📒 k8s 部署相关</p><p>使用 Docker Desktop 搭建 k8s 集群</p><p><a href="https://mp.weixin.qq.com/s/DEZPCzQul7wnZKqm1Ue6rg" target="_blank" rel="noopener noreferrer">从Go程序第一行代码，到在 K8s 上运行，要经历多少步</a></p><p><a href="https://mp.weixin.qq.com/s/ZU61NIMxh_UOo-chNvkPXA" target="_blank" rel="noopener noreferrer">在K8S上的Web服务该怎么做域名解析呢</a></p><p><a href="https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress/</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/IYZrtK7pJTeCOBwY-sC9HA" target="_blank" rel="noopener noreferrer">字节一面：HTTPS 一定安全可靠吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/cbKpWKWrhyJwKQhlyYhQ_w" target="_blank" rel="noopener noreferrer">如何在项目开发中逐步成长</a></p><p>📒 Golang 相关文章</p><p>Go 语言里使用 <code>io.Reader</code> 和 <code>io.Writer</code> 两个 interface 来抽象 <code>I/O</code>，他们的定义如下：</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Reader </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Writer </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">Write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token builtin">error</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>io.Reader</code> 接口代表一个可以从中读取字节流的实体，而 <code>io.Writer</code> 则代表一个可以向其写入字节流的实体。</p><ul><li>⭐️ <a href="https://mp.weixin.qq.com/s/SpVTl64W1Exy8fuN15-kmA" target="_blank" rel="noopener noreferrer">Go指针的使用限制和突破之路</a></li><li>⭐️ <a href="https://mp.weixin.qq.com/s/TtN6NZ8hQ2AIf0C8wVzkjA" target="_blank" rel="noopener noreferrer">Go语言的IO库那么多，我该怎么选</a></li><li><a href="https://mp.weixin.qq.com/s/gYWhjh1BburgeAU72mn_aw" target="_blank" rel="noopener noreferrer">Go 眼中的文件系统是什么？ io.FS</a></li><li><a href="https://mp.weixin.qq.com/s/0c7emt54ayCrm1K16lk2SQ" target="_blank" rel="noopener noreferrer">如何更直观地理解 Go 调度过程</a></li><li><a href="https://mp.weixin.qq.com/s/FviFOLkIHuEjZdTg_qCoNQ" target="_blank" rel="noopener noreferrer">Go1.19 那些你不知道的新特性</a></li><li><a href="https://mp.weixin.qq.com/s/SrqJdng9cNUEVAS7nFaqAA" target="_blank" rel="noopener noreferrer">Go 中可别用复制锁，会有这些大问题！</a></li></ul><p>⭐️ <a href="https://mp.weixin.qq.com/s/fb2uUWz5ZjPEfYv_l6e4Zg" target="_blank" rel="noopener noreferrer">能ping通，TCP就一定能连通吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/RJp9s_shNckkHBqHsJThuA" target="_blank" rel="noopener noreferrer">Linux 是如何收发网络包的</a></p><p>📒 Golang 依赖注入相关文章</p><p><a href="https://dev.to/dryrainbow/dependency-injection-in-golang-35oa" target="_blank" rel="noopener noreferrer">https://dev.to/dryrainbow/dependency-injection-in-golang-35oa</a></p><p><a href="https://medium.com/avenue-tech/dependency-injection-in-go-35293ef7b6" target="_blank" rel="noopener noreferrer">https://medium.com/avenue-tech/dependency-injection-in-go-35293ef7b6</a></p><p><a href="https://medium.com/thirdfort/go-best-practices-how-to-code-comfortably-60118a27def8" target="_blank" rel="noopener noreferrer">https://medium.com/thirdfort/go-best-practices-how-to-code-comfortably-60118a27def8</a></p><p><a href="https://levelup.gitconnected.com/better-error-handling-in-golang-theory-and-practical-tips-758b90d3f6b4" target="_blank" rel="noopener noreferrer">https://levelup.gitconnected.com/better-error-handling-in-golang-theory-and-practical-tips-758b90d3f6b4</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/cKC8u_43Ewqq0GAgErQO0w" target="_blank" rel="noopener noreferrer">【第2704期】网易严选多端组件库OSSA正式开源</a></p><p>📒 Golang 相关文章</p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzNTY5MzU2MA==&amp;action=getalbum&amp;album_id=1323498303014780929&amp;scene=21&amp;from_msgid=2247484112&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" target="_blank" rel="noopener noreferrer">Go 语言 Web 编程</a></p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzNTY5MzU2MA==&amp;action=getalbum&amp;album_id=1325302744319737858&amp;scene=21&amp;from_msgid=2247484375&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" target="_blank" rel="noopener noreferrer">Go 语言并发编程</a></p><p><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzUzNTY5MzU2MA==&amp;action=getalbum&amp;album_id=1809543596702777345&amp;scene=21&amp;from_msgid=2247492061&amp;from_itemidx=1&amp;count=3&amp;nolastread=1#wechat_redirect" target="_blank" rel="noopener noreferrer">Go 微服务实战</a></p><p>📒 React 18 新特性：Selective Hydration</p><p><a href="https://github.com/reactwg/react-18/discussions/37" target="_blank" rel="noopener noreferrer">https://github.com/reactwg/react-18/discussions/37</a></p><p>📒 <a href="https://juejin.cn/post/7122636487555809311" target="_blank" rel="noopener noreferrer">一个简洁、强大、可扩展的前端项目架构是什么样的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/fxEKYW5cIKM5tec3VWwgSw" target="_blank" rel="noopener noreferrer">大家都能看得懂的源码之ahooks useInfiniteScroll</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/37DtrXeRioq-xSKayIJbCg" target="_blank" rel="noopener noreferrer">esModuleInterop 是如何影响 tsc 的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/1h6yqCWyzYLM8WPGlGdtVA" target="_blank" rel="noopener noreferrer">【第2703期】软件架构手册</a></p><p>📒 <a href="https://juejin.cn/post/6844903956263501838" target="_blank" rel="noopener noreferrer">如何在 Web 上构建一个插件系统</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/XX3Y1tKU-_oeNGsXfgcNQg" target="_blank" rel="noopener noreferrer">Go 的常量为什么只支持数字、字符串这样的基础类型</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/DZbAq9fpPxElhfJCkY53GA" target="_blank" rel="noopener noreferrer">两万字详解！InnoDB锁专题！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/cDCHV08x1rPiZVZMRFjWBg" target="_blank" rel="noopener noreferrer">细数线程池的10个坑</a></p><p>📒 <a href="https://juejin.cn/post/7132077894922141726" target="_blank" rel="noopener noreferrer">Chrome DevTools 远程调试安卓网页的原理</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/RSSQymhS48pFXI2Z9JX6TA" target="_blank" rel="noopener noreferrer">Windows 滚动条如何美化成 macOS 那样</a></p><p>📒 <a href="https://juejin.cn/post/7131947887398748196" target="_blank" rel="noopener noreferrer">Go逃逸分析详解</a></p><p>📒 <a href="https://juejin.cn/post/7131717990558466062" target="_blank" rel="noopener noreferrer">GO面试必知必会面试题</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/1ZuhUA9Lt2uLFlamIY6fLQ" target="_blank" rel="noopener noreferrer">最简单的单例模式，Go版本的实现你写对了吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/zyvO_hhUo1TRm6kMPcaFFQ" target="_blank" rel="noopener noreferrer">伙计，Go项目怎么使用枚举</a></p><p>📒 <a href="https://juejin.cn/post/7131928500373553160" target="_blank" rel="noopener noreferrer">Astro 1.0 正式发布，给前端带来了什么</a></p><p>📒 gum</p><p>迷人的 shell 脚本工具库，基于 go。</p><blockquote><p><a href="https://github.com/charmbracelet/gum" target="_blank" rel="noopener noreferrer">https://github.com/charmbracelet/gum</a></p></blockquote><p>📒 React Query 转 RTK</p><p>本文是作者和 React Query 斗争了一年之后，最终弃 React Query 投 RTK 的故事。</p><p>React Query 处理了复杂的缓存，并根据需要重新加载数据。用户使用 useQuery 调用 API 时，数据被存储在 React Query 的缓存中。缓存的数据可通过 getQueryData 读取。如果要更新数据，使用 useMutation 会更新服务群上的数据，同时在 onSuccess 或 onMutate 中更新 React Query 缓存中的数据。更新的最简单方法是调用 invalidateQueries。而缓存失效正是作者觉得 React Query 难以驾驭的主要原因。</p><p>然后作者在对比之后选择了 Redux + Redux Toolkit（RTK）。作者希望选择全局 store 的数据流，同时还对比了竞品比如 Valtio（见上图）。Redux 的优点是社区、文档、明确的数据结构，缺点是更多脚手架代码、需要用 reselect 或其他来做渲染优化、尺寸比较大（18K）。</p><p>编者注：如果我是作者，在需要全局 store 的前提下，会更倾向于选择 valtio 或 zustand。1）脚手架代码少，这一点对外来说很关键，2）性能更好（valtio 基于使用决定 re-render），3）redux 的单 store 在未来可能成为瓶颈，比如要做组件提取时，多 store 会更灵活一些。</p><blockquote><p><a href="https://www.basedash.com/blog/why-we-had-to-move-away-from-react-query" target="_blank" rel="noopener noreferrer">https://www.basedash.com/blog/why-we-had-to-move-away-from-react-query</a></p></blockquote><p>📒 Suspense</p><p>作者在一年前写了第一篇，这是第二篇。时隔一年，这篇是他几个月的研究成果。</p><p>这段时间发生了什么？1）React 团队创建 React 18 工作小组讨论区，提供更多深入的信息，同时用于收集反馈，2）React 18 稳定版发布，3）一篇 React Labs 的帖子，介绍 React 团队正在探索的内容。</p><p>React 18 有啥新特性？1）没有并发模式，取而代之的是并发功能，仅在子树中启用，原因是为了向后兼容，2）Transition 允许将不紧急的更新标记为过渡（未来可能成为默认行为），3）基于 Suspense 的 Streaming SSR 允许在所有 HTML 被渲染之前进行流化，并且在 HTML 被完全流化之前就可以开始水化（目前需搭配 React.lazy 使用），4）选择性水化，5）新 Hooks，比如 useId 可用来生成在客户端和服务端稳定的 ID，6）自动批处理 让多个 setState 只导致单一渲染。</p><p>React 下一步做什么？1）Cache 组件，允许请求库做与 Suspense + 并发渲染兼容的数据缓存，这是 Suspense 目前缺的一环，2）React Server Component，3）用于 Assets 资源加载的 Suspense，比如字体、CSS 和字体等会在加载时导致布局偏移和混乱，4）React 编译器优化，React 慢的原因之一是因为有大量不必要的 re-render，自动插入 memo hook 可以提升性能，这在 React Conf 2021 中有过介绍，5）SuspenseList，在处理 Suspense 列表时有用，比如文章、评论或消息，允许协调子节点，决定他们显示的顺序，6）Offscreen API，允许保留 unmount 组件的状态，或者预先渲染用户可能会执行的 transition，比如做基于路由的预渲染。</p><p>跳出 React 从整体社区角度看。1）流式服务端渲染是为了提高响应速度，所以尽可能早地 flush，MarkoJS 在 2014 年开始支持，更早一些 Facebook 在 2009 年也有一门叫 BigPipe 的技术，2）SSR 在网络方面会更快，但同步水化依旧会成为大型项目的性能瓶颈，Islands architecture(群岛架构） 可以解这个问题，3）细粒度响应式，「React 虽然叫 react，但实际上不是 react」，响应式是框架中很流行的一种优化方法，比如 SolidJS，React 团队也有考虑过这个问题，但选择不追求，Dan 早在 2019 年就写过这个话题，4）Transition API 不算新技术，谷歌地图也有类似实现，同时 Scheduling（调度）问题正在通过标准的方式解决，5）SRC（服务端渲染组件）也不是新想法，2018 年就有 Phoenix LiveView 的实现，通过服务端状态和渲染实现 0 JS 的交互功能。</p><p>最后，作者还发现，React 项目内部子项目代号均是以 F 开头。比如 Fiber 是实现了异步渲染的重写的核心代号；Fizz 是新的服务器端渲染架构的代号、Flight 是服务器组件的代号、Fire、Flare 等。</p><blockquote><p><a href="https://blog.6nok.org/the-suspense-is-killing-me:-part-2/" target="_blank" rel="noopener noreferrer">https://blog.6nok.org/the-suspense-is-killing-me:-part-2/</a></p></blockquote><p>📒 React TypeScript 备忘录</p><p>一份很全面的 React TypeScript 备忘录。</p><blockquote><p><a href="https://react-typescript-cheatsheet.netlify.app/" target="_blank" rel="noopener noreferrer">https://react-typescript-cheatsheet.netlify.app/</a></p></blockquote><p>📒 React re-render 指南</p><p>关于 React 重渲染的系列指南，图文并茂，同时提供了代码示例和扩展资料。</p><blockquote><p><a href="https://www.developerway.com/posts/react-re-renders-guide" target="_blank" rel="noopener noreferrer">https://www.developerway.com/posts/react-re-renders-guide</a></p></blockquote><p>📒 ESLint 推出新的配置系统</p><p>回顾当前的 eslintrc 配置系统演进史，每一步的演化在当时来看都是不错的选择，比如 extends、Personal configs、多种配置文件格式、可共享的配置和依赖项(npm 背锅)、root、overrides、添加 extends 到 overrides 等等。</p><p>然而时至今日，随着 JavaScript 项目越来越庞大，从整体上再来看这些配置就太复杂了。为了简化配置，ESLint 团队经过 18 个月的修订和讨论，决定着手构建一个全新的配置系统 flat config，现在可以在 ESLint v8.21.0 中通过 API 使用。</p><blockquote><p><a href="https://eslint.org/blog/2022/08/new-config-system-part-1/" target="_blank" rel="noopener noreferrer">https://eslint.org/blog/2022/08/new-config-system-part-1/</a></p></blockquote><blockquote><p><a href="https://eslint.org/blog/2022/08/new-config-system-part-2/" target="_blank" rel="noopener noreferrer">https://eslint.org/blog/2022/08/new-config-system-part-2/</a></p></blockquote><blockquote><p><a href="https://eslint.org/blog/2022/08/new-config-system-part-3/" target="_blank" rel="noopener noreferrer">https://eslint.org/blog/2022/08/new-config-system-part-3/</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/3fMZN_LidCi5fiD16nNWWA" target="_blank" rel="noopener noreferrer">字节一面：TCP 和 UDP 可以使用同一个端口吗</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/8月14日内容汇总">8月14日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-14T00:00:00.000Z" itemprop="datePublished">August 14, 2022</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://mp.weixin.qq.com/s/hRR_sp3w_dgnUbdNXMuL7w" target="_blank" rel="noopener noreferrer">将微前端做到极致-无界方案</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/9eZxW9qihgQlbBP0D0ZMQQ" target="_blank" rel="noopener noreferrer">【第2701期】技术Leader如何创造业务价值</a></p><p>📒 <a href="https://zhuanlan.zhihu.com/p/456483953" target="_blank" rel="noopener noreferrer">Monorepo 下的模块包设计实践</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/rZ96wy8xUrx4T1qG5OKS0w" target="_blank" rel="noopener noreferrer">【TypeScript】never 和 unknown 的优雅之道</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/nk5SN8AKwyFkUTEOiLCBdQ" target="_blank" rel="noopener noreferrer">Bundle-less 的思考和实践分享</a></p><p>📒 <a href="https://segmentfault.com/a/1190000042271919" target="_blank" rel="noopener noreferrer">React Fiber架构原理剖析</a></p><p>📒 <a href="https://juejin.cn/post/7129747165794009101" target="_blank" rel="noopener noreferrer">【万字】优化Webpack？肘，跟我进屋聊聊</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/-eEMSn2WpDiMbNSBgY3-pg" target="_blank" rel="noopener noreferrer">字节的前端监控 SDK 是怎样设计的</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/ioDYZjdSii3WUvL9xqc_Sg" target="_blank" rel="noopener noreferrer">别再乱打日志了，这份 Java 日志规范，应有尽有，建议收藏！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/l3jJHIcqMzCcezbpboqyvQ" target="_blank" rel="noopener noreferrer">explain | 索引优化的这把绝世好剑，你真的会用吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/3jrf1GKBBbVzcvJxqYnx9Q" target="_blank" rel="noopener noreferrer">这11条接口性能优化技巧，利好每日睡眠</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Y1Mh-99cgQWuCQ53wAxkUQ" target="_blank" rel="noopener noreferrer">顺丰快递：请签收MySQL灵魂十连</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/UL5d3P6sjT36njR4RYMFkQ" target="_blank" rel="noopener noreferrer">Go Mod小知识：伪版本</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/XPPwHd7eDUjvzsnuFwgbyw" target="_blank" rel="noopener noreferrer">Go ORM 单元测试全流程讲解</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/r30z2i_sSuRfEnM_23wFlg" target="_blank" rel="noopener noreferrer">超全总结：Go语言如何操作文件</a></p><p>📒 React 服务端渲染遇到的问题</p><p>在服务端渲染场景下，不能使用 <code>style-loader</code>，需要用 <code>isomorphic-style-loader</code> 注入样式。</p><blockquote><p><code>style-loader</code> 内部使用了 dom API 把样式注入到 <code>style</code> 标签中，在 Node 环境下会报错</p></blockquote><p>React 期望在服务端和客户端渲染的内容是相同的，客户端渲染会默认复用服务端渲染的 dom。如果需要在服务端和客户端上渲染不同的内容，可以设置一个 <code>isClient</code> 变量：</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyComponent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">PureComponent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">isClient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">componentDidMount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 这里在客户端 hydrate 的时候执行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">isClient</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> isClient </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">isClient</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 当需要渲染的组件需要访问浏览器 API，在 Node 环境会报错</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 这里可以渲染 fallback 的内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 在客户端可以正常渲染组件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>当需要渲染的组件需要访问浏览器 API（例如 <code>window</code>、<code>document</code>、<code>location</code>），在 Node 环境会报错。在服务端渲染的时候，可以先渲染 fallback 内容，在客户端 hydrate 的时候，再渲染正常组件。</p><p>另外有一些 SDK，内部可能也访问了浏览器 API，这种情况下不能直接在构造器中初始化实例，可以在 <code>componentDidMount</code> 钩子中延迟初始化。</p></div></div><blockquote><p><a href="https://17.reactjs.org/docs/react-dom.html#hydrate" target="_blank" rel="noopener noreferrer">https://17.reactjs.org/docs/react-dom.html#hydrate</a></p></blockquote><p>📒 vite 代码压缩遇到的问题</p><p>vite 默认使用 esbuild 压缩，esbuild 不仅会做常规的压缩，而且还会在 <code>target</code> 配置允许的范围内做一些语法转换，进一步减小 bundle 体积。</p><p>例如在业务中有下面一段代码：</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 这边没有用到 err 参数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>经过 esbuild 压缩之后，<code>try...catch</code> 后面的括号直接不见了（这实际上是 ES2019 中的 <code>optional-catch-binding</code> 语法），在一个老业务工程构建的时候，Babel 无法识别这种语法，直接报错了：</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>有两种解决方案：</p><ul><li>一种是使用 terser 压缩，设置 <code>minify: &quot;terser&quot;</code></li><li>另一种继续使用 esbuild，但是手动设置 <code>target: &quot;es2015&quot;</code></li></ul><blockquote><p><a href="https://vitejs.dev/config/build-options.html#build-target" target="_blank" rel="noopener noreferrer">https://vitejs.dev/config/build-options.html#build-target</a></p></blockquote><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>在一般前端项目中，<code>target</code> 配置是针对 Babel 的，即最终的产物兼容性由 Babel 决定。</p><p>但是在 Vite 中，Babel 只参与部分 esbuild 尚不支持的提案阶段的语法转换，并不决定最终产物兼容性，最终的兼容性由 esbuild 决定。注意 esbuild 默认的 target 值为 <code>&quot;esnest&quot;</code>，即 esbuild 认为环境支持最新的 JS 语法特性。但是在 Vite 中，<code>build.target</code> 默认为一个特殊值 <code>&quot;modules&quot;</code>（即支持原生 ES Module、动态导入语法和 <code>import.meta</code> 语法，对应 Chrome &gt;=87），最低可以支持 <code>&quot;es2015&quot;</code>。</p><p>注意 Vite 默认只做语法转换，并不会引入 polyfill（适合第三方库开发，由业务工程 <code>@babel/preset-env</code> 配置 <code>useBuiltIns: &quot;entry&quot;</code> 统一引入 polyfill）。如果产物需要直接在浏览器中运行，则需要 <code>@vitejs/plugin-legacy</code> 插件。该插件会对最终 bundle 中每个 chunk，使用 <code>@babel/preset-env</code> 转换生成对应的 legacy chunk，同时根据 <code>target</code> 配置的目标浏览器兼容性和实际用到的 API，生成一个 polyfill chunk。</p><p><a href="https://vitejs.dev/guide/build.html#browser-compatibility" target="_blank" rel="noopener noreferrer">https://vitejs.dev/guide/build.html#browser-compatibility</a></p></div></div><p>📒 Golang 标准库 strings</p><p>重点看一下 <code>strings.Builder</code> 的用法。</p><p><a href="https://blog.csdn.net/qq_24433609/article/details/124500115" target="_blank" rel="noopener noreferrer">Go 学习之 strings.Builder 篇</a></p><p><a href="https://www.cnblogs.com/cheyunhua/p/15769717.html" target="_blank" rel="noopener noreferrer">Go 字符串拼接6种，最快的方式 -- strings.builder</a></p><p><a href="https://blog.csdn.net/qq_41035588/article/details/108289761" target="_blank" rel="noopener noreferrer">Go拼接字串的三种方法 Go1.10中的strings.Builder</a></p><p><a href="https://pkg.go.dev/strings@go1.19" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/strings@go1.19</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/usDh1-Wzxrf4BftfWhwduA" target="_blank" rel="noopener noreferrer">你需要知道的TypeScript高级类型</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/HaF9qieEJWNUoyY9qTvnKw" target="_blank" rel="noopener noreferrer">Go 的时间转换和时区校对总记不住？给你一份备忘单</a></p><p>📒 <a href="https://juejin.cn/post/7121520457760653349" target="_blank" rel="noopener noreferrer">两个真实线上升级故障让你彻底搞懂package.json中的脱字符(^)</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/6Er2IQEXXNc8Sb5vVJZZOQ" target="_blank" rel="noopener noreferrer">【第2696期】React 状态管理的新浪潮</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/X60eIQcEAJz8tvNz5qArxg" target="_blank" rel="noopener noreferrer">Go 创始人教你如何处理错误</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/4Sxal7N-uZ8gvphC8XWo8A" target="_blank" rel="noopener noreferrer">总监又来了，人狠话不多，这篇 gRPC，小弟佩服！</a></p><p>📒 React 性能优化, 从 500 毫秒到 1.7 毫秒</p><blockquote><p><a href="https://orizens.com/blog/500ms-to-1-7ms-in-react-a-journey-and-a%20checklist/" target="_blank" rel="noopener noreferrer">https://orizens.com/blog/500ms-to-1-7ms-in-react-a-journey-and-a%20checklist/</a></p></blockquote><p>📒 <a href="https://juejin.cn/post/7129520818232492040" target="_blank" rel="noopener noreferrer">UMD 的包如何导出 TS 类型</a></p><p>📒 <a href="https://juejin.cn/post/7116141318853623839" target="_blank" rel="noopener noreferrer">为什么 React 的 Diff 算法不采用 Vue 的双端对比算法</a></p><p>📒 <a href="https://juejin.cn/post/7129267782515949575" target="_blank" rel="noopener noreferrer">🚀Turborepo：发布当月就激增 3.8k Star，这款超神的新兴 Monorepo 方案，你不打算尝试下吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/ptJK7CDHCr6P4JCdsUXKdg" target="_blank" rel="noopener noreferrer">搞清楚 Go Mod的版本和伪版本，下次别乱用了</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Nu4XCuF4d_BaAkmwRr3f4A" target="_blank" rel="noopener noreferrer">掌握 TypeScript 中的映射类型</a></p><p>📒 React Re-render 指南</p><p>什么是 re-render？什么是必要的 re-render 和不必要的 re-render？如果你对这些问题还模模糊糊的，在这篇文章中可以找到答案。</p><p>有四个原因可以让一个组件重新渲染自己：状态变化、父级（或子级）重新渲染、上下文变化和 hooks 变化。</p><p>通过 composition（组合）可以避免 re-render。有几种方式，1）把状态下移，避免上层组件 re-render，让 re-render 保持在一个很小的范围之内，2）children as props，作为 props，子组件不会受 state 变更的影响，3）component as props，避免 component re-render。</p><p>通过 React.memo 可以避免 re-render，被 memo 的组件只在 props 变更时会 re-render。有几种方式，1）对于带 props 的 component，需对非原始值的 props 做 memo，2）components as props or children，对子组件做 memo 而不要对父组件做 memo。</p><p>什么时候应该用 useMemo/useCallback？1）React.memo 过的组件的 props 应该用，因为他们只有 props 变更时才会 re-render，所以反之非 React.memo 过的组件的 props 无需使用，因为都会 re-render，用了也白用，2）useEffect、useMemo、useCallback 中非原始值的依赖应该用，3）重消耗（比如生成渲染树）的部分应该用，反之轻消耗不要用，因为 useMemo/useCallback 本身也有消耗。</p><p>如何防止 Context 引起的 re-render？1）memo context value，避免父级组件 re-render 导致 value 变更从而让依赖 context 的地方全部 re-render，2）拆分 data 和 API（getter 和 setter），这样 getter 变更时依赖 setter 的部分不会 re-render，3）把数据拆小，4）使用 context selector 比如 use-context-selector。</p><blockquote><p><a href="https://www.developerway.com/posts/react-re-renders-guide" target="_blank" rel="noopener noreferrer">https://www.developerway.com/posts/react-re-renders-guide</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/vRI-bFB4_IEaoCCQcMqZjw" target="_blank" rel="noopener noreferrer">明明加了唯一索引，为什么还是产生重复数据</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/0Jn1CHAVyX1U8RD2OUJENQ" target="_blank" rel="noopener noreferrer">现代前端测试框架 Vitest 的一些落地实践感悟</a></p><p>📒 <a href="https://juejin.cn/post/7129130418657296421" target="_blank" rel="noopener noreferrer">如何用 Project Reference 优化 tsc 编译性能</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/8月7日内容汇总">8月7日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-07T00:00:00.000Z" itemprop="datePublished">August 7, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://mp.weixin.qq.com/s/O6sgYSpXBPwAA4Qcstj-BA" target="_blank" rel="noopener noreferrer">互联网公司都怎么实现分页的，拿 MySQL 使劲Limit</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/OKUeAdicn0Bvkz8dYx1epQ" target="_blank" rel="noopener noreferrer">拒绝 Go 代码臃肿，其实在这几块可以用下观察者模式</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Yh2dOC8Pumeis-h1_gMLjg" target="_blank" rel="noopener noreferrer">记一次线上超时问题的发现、排查、定位以及解决过程</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Dn2oM89mHEgoz8yVQnNEoQ" target="_blank" rel="noopener noreferrer">这不会又是一个Go的BUG吧</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/YojNHW7kkjmmdjqBXCuQYA" target="_blank" rel="noopener noreferrer">这三个 Go 水平自测题，手写不出来还是先老实上班吧</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/pR_XHTnhft2Hi_mY7JuEJg" target="_blank" rel="noopener noreferrer">不想Go 错误处理太臃肿，可以参考这个代码设计</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/HuZn9hnHUBx3J4bAGYBYpw" target="_blank" rel="noopener noreferrer">关于Go程序错误处理的一些建议</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/tw4lD0XA67yJKAwIWVicIQ" target="_blank" rel="noopener noreferrer">你见过哪些目瞪口呆的 Java 代码优化技巧</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/AOshaWGmLw6uw92xKhLAvQ" target="_blank" rel="noopener noreferrer">聊聊 13 种锁的实现方式</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/cPrhhSv1KkwkYdxPAfvkDA" target="_blank" rel="noopener noreferrer">代码越写越乱？那是因为你没用责任链！</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/QWoVKFzFJUHNmmz89mMH1g" target="_blank" rel="noopener noreferrer">社招后端21连问（三年工作经验一面）</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/qrmdU5ijy3P6SeP-MAVjJw" target="_blank" rel="noopener noreferrer">Spring Boot 实现接口幂等性的 4 种方案</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/ANuNr1mtFZCu4S4WuNYNlg" target="_blank" rel="noopener noreferrer">前端运维部署那些事</a></p><p>📒 rollup 最佳实践！可调试、编译的小型开源项目思路</p><p>tsc 可以只生成类型声明文件：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tsc  --emitDeclarationOnly --declaration --project ts.config.json --outDir dist/esm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://mp.weixin.qq.com/s/-fn8ynYuvRcnDLB5VqRBFg" target="_blank" rel="noopener noreferrer">rollup 最佳实践！可调试、编译的小型开源项目思路</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/Gd7RLj1aRoJa6Jd2gi8vNA" target="_blank" rel="noopener noreferrer">脚本任务执行器 —— npm-run-all 源码解析</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/79ELfeZ09HAl1lFaeONyLA" target="_blank" rel="noopener noreferrer">2022年值得推荐的React库！</a></p><p>📒 <a href="https://juejin.cn/post/7121244973558661150" target="_blank" rel="noopener noreferrer">超大体量项目，微前端落地方案，看完后悔来找我</a></p><p>📒 <a href="https://juejin.cn/post/7127953386514677790" target="_blank" rel="noopener noreferrer">如何解决前端常见的竞态问题</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/2IGogbnvxG1O_PYy49fv8g" target="_blank" rel="noopener noreferrer">Go语言中常见100问题-#88-1 Not using testing utility packages</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/DnCc5NIrMzvJuTF_xN6RYQ" target="_blank" rel="noopener noreferrer">字节二面，差点没答好</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/pxbQbvZP2IWMQzA7v8YV4w" target="_blank" rel="noopener noreferrer">如何提高 TypeScript 的代码质量</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/A6lTimcViHjIigj4V6Dasg" target="_blank" rel="noopener noreferrer">谁说 Mysql 单表最大 2000 W ？我硬要塞它 1 个亿！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/teFxhgzag8k5EXVnccdMkA" target="_blank" rel="noopener noreferrer">初探 Vue3 编译之美</a></p><p>📒 Go 1.19 is released</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ go </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> golang.org/dl/go1.19@latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>go 命令使用：<a href="https://pkg.go.dev/cmd/go" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/cmd/go</a></p></blockquote><p>📒 GitHub Trending - TypeScript</p><p><a href="https://github.com/trending/typescript" target="_blank" rel="noopener noreferrer">https://github.com/trending/typescript</a></p><p>📒 <a href="https://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&amp;mid=2247492602&amp;idx=1&amp;sn=135fd5b530189f13e0395414a6b47893" target="_blank" rel="noopener noreferrer">【表达式计算】双栈 : 表达式计算问题的通用解法</a></p><p>📒 构建自己的 Web 框架</p><p>这篇文章解释了如何构建基于 React 的简易 Web 框架，并使用 Vercel 的 Build Output API 进行部署。</p><p>Build Output API 是一个基于文件系统的规范，用于生成 Vercel 部署的目录结构。框架作者可以将此目录结构实现为他们构建命令的输出，以便框架可以利用所有 Vercel 的平台功能(Serverless Functions，Edge Functions，路由，缓存等)，Astro已经成功与 Vercel 集成。</p><p><a href="https://vercel.com/blog/build-your-own-web-framework" target="_blank" rel="noopener noreferrer">https://vercel.com/blog/build-your-own-web-framework</a></p><p>📒 <a href="https://github.com/BetaSu/big-react" target="_blank" rel="noopener noreferrer">从零实现 React v18 的核心功能</a></p><p>📒 <a href="https://deno.com/blog/roll-your-own-javascript-runtime" target="_blank" rel="noopener noreferrer">Roll your own JavaScript runtime</a></p><p>📒 <a href="https://github.com/ronami/HypeScript" target="_blank" rel="noopener noreferrer">用 TS 的类型系统实现一个 TS 类型系统</a></p><p>📒 <a href="https://github.com/sunym1993/flash-linux0.11-talk" target="_blank" rel="noopener noreferrer">像小说一样品读 Linux 0.11 核心代码</a></p><p>📒 <a href="https://juejin.cn/post/7126921039098937357" target="_blank" rel="noopener noreferrer">前端食堂技术周刊第 46 期：Chrome 三方 cookie 计划、npm 引入更多安全增强功能、Awesome Bun</a></p><p>⭐️ 看一下 React 15.x 源码</p><blockquote><p><a href="https://github.com/Lucifier129/react-lite" target="_blank" rel="noopener noreferrer">https://github.com/Lucifier129/react-lite</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/UELHBolk-UVC45H1QvtrLQ" target="_blank" rel="noopener noreferrer">Go语言中常见100问题-#87 Not dealing with the time API efficiently</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/8cXYXAHZCJMPSaaMpDqYtQ" target="_blank" rel="noopener noreferrer">用了TCP协议，就一定不会丢包吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/hVoVdvt_sHUuVxvfSwgEVQ" target="_blank" rel="noopener noreferrer">【第2688期】关于低代码平台建设的思考与实践暨BPM表单设计器前端技术解析</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/7月31日内容汇总">7月31日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-07-31T00:00:00.000Z" itemprop="datePublished">July 31, 2022</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 <a href="https://juejin.cn/post/7126501202866470949" target="_blank" rel="noopener noreferrer">全网最优雅的 React 源码调试方式</a></p><p>📒 <a href="https://juejin.cn/post/7126477752718327839" target="_blank" rel="noopener noreferrer">如何实现一个跨框架的组件库文档</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/1BdXL5dQfP6DnK7iJs6zGQ" target="_blank" rel="noopener noreferrer">入职Apifox研发组半年，我所提升的软技能｜文末抽书</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/cdc1NCSkvAU4Urk2wVFDMw" target="_blank" rel="noopener noreferrer">几个提升Go语言开发效率的小技巧</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/15YxshMsZ7FJyLUfXZHqCQ" target="_blank" rel="noopener noreferrer">最近对前端构建工具的一些理解</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/yUg-9H0GgzbavuxuU8Aahw" target="_blank" rel="noopener noreferrer">Go语言中常见100问题-#86 Sleeping in unit tests</a></p><p>📒 <a href="https://juejin.cn/post/7125613440000851975" target="_blank" rel="noopener noreferrer">超实用的Chrome DevTools调试技巧</a></p><p>📒 开源项目推荐</p><p>用 Go 写的 GUI gRPC 客户端。作者在调试 gPRC 接口时，发现没有类似 postman 趁手的 gPRC 客户端，所以就自己动手写了一个然后开源了。</p><blockquote><p><a href="https://github.com/crossoverJie/ptg" target="_blank" rel="noopener noreferrer">https://github.com/crossoverJie/ptg</a></p></blockquote><p>Go DDD 示例项目。该项目通过一个预约系统的示例，展示了如何在 Go 项目中实现领域驱动设计(DDD)和读写分离架构(CQRS)。</p><blockquote><p><a href="https://github.com/ThreeDotsLabs/wild-workouts-go-ddd-example" target="_blank" rel="noopener noreferrer">https://github.com/ThreeDotsLabs/wild-workouts-go-ddd-example</a></p></blockquote><p>一款静态应用程序安全测试(SAST)工具。它可以检测项目中是否包含密码、API Key、token 等信息，还能够轻松整合到 Git Hook 和 GitHub Action，实现提交代码时自动检测，通过告警和阻止 push 等方式，有效地防止敏感信息泄漏。</p><blockquote><p><a href="https://github.com/zricethezav/gitleaks" target="_blank" rel="noopener noreferrer">https://github.com/zricethezav/gitleaks</a></p></blockquote><p>在线可视化正则编辑器。该项目可将输入的正则表达式，自动生成对应的可视化图形，支持通过编辑图形节点修改正则表达式，以及对正则表达式进行测试等功能。</p><blockquote><p><a href="https://github.com/Bowen7/regex-vis" target="_blank" rel="noopener noreferrer">https://github.com/Bowen7/regex-vis</a></p></blockquote><p>📒 <a href="https://mp.weixin.qq.com/s/ORqdfZZ8qFyJdYTRwEULgQ" target="_blank" rel="noopener noreferrer">前端构建效率优化之路</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/DuQzAumv_eB6Wc-YGVbe5g" target="_blank" rel="noopener noreferrer">Esbuild Bundler HMR</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/bHdzGYSKC9SNoA7dpVvNsw" target="_blank" rel="noopener noreferrer">面试突击69：TCP 可靠吗？为什么</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/NUnaiVWADxzDOYPQdAwm6w" target="_blank" rel="noopener noreferrer">招银网络一面：AOP 了解吗？有什么用？切面执行顺序如何控制</a></p><p>⭐️ <a href="https://juejin.cn/post/7125066863150628900" target="_blank" rel="noopener noreferrer">Nest 的实现原理？理解了 reflect metadata 就懂了</a></p><p>📒 <a href="https://juejin.cn/post/7123969545387114509" target="_blank" rel="noopener noreferrer">耽误你十分钟！🎃你可能用得上这些webpack5新特性</a></p><p>📒 <a href="https://juejin.cn/post/7118782372220567566" target="_blank" rel="noopener noreferrer">入职即巅峰？🧨基建优化项目体积减少20%！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/XznUiQUq5vRWFLgbz2u8Dg" target="_blank" rel="noopener noreferrer">简单好用的前端拖拽排序库</a></p><p>📒 <a href="https://juejin.cn/post/7124601707702517797" target="_blank" rel="noopener noreferrer">你能给前端工程化下个定义么</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/KsoSwA73PzGwYMqZOwUvNQ" target="_blank" rel="noopener noreferrer">你需要知道的ES6—ES13开发技巧！</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/PL_uWkSTo12hxmxMmUKndw" target="_blank" rel="noopener noreferrer">【第2682期】前端场景下请求的Race Conditions</a></p><p>📒 介绍几个相对冷门的 React Hook</p><blockquote><p><a href="https://css-tricks.com/react-hooks-the-deep-cuts/" target="_blank" rel="noopener noreferrer">https://css-tricks.com/react-hooks-the-deep-cuts/</a></p></blockquote><p>📒 Remix 和 Next.js 的区别</p><p>本文对这两个基于 React 的框架进行了逐个特性的比较，它们有很多相似之处，但也有一些关键的区别。</p><blockquote><p><a href="https://www.smashingmagazine.com/2022/07/look-remix-differences-next/" target="_blank" rel="noopener noreferrer">https://www.smashingmagazine.com/2022/07/look-remix-differences-next/</a></p></blockquote><p>📒 阅读源码之 React 篇</p><p>本文并不是要详尽地描述 React 是如何工作的，而是主要关注了 React 的设计和 React 开发人员多年来采用的实践。</p><blockquote><p><a href="https://alexkondov.com/readint-source-code-react/" target="_blank" rel="noopener noreferrer">https://alexkondov.com/readint-source-code-react/</a></p></blockquote><p>📒 <a href="https://www.bmpi.dev/dev/deep-in-program-language/how-to-implement-generics/" target="_blank" rel="noopener noreferrer">编程语言是如何实现泛型的</a></p><p>📒 Vue 编译三部曲</p><p><a href="https://mp.weixin.qq.com/s/5GSrv0xV5a1VqkKuPGgTRw" target="_blank" rel="noopener noreferrer">Vue 编译三部曲：如何将 template 编译成 AST</a></p><p><a href="https://mp.weixin.qq.com/s/-Wo1_GfMyVgDckpNnL42wQ" target="_blank" rel="noopener noreferrer">Vue 编译三部曲：模型树优化</a></p><p><a href="https://mp.weixin.qq.com/s/K0za54kUIYXXpz3BS8XQkw" target="_blank" rel="noopener noreferrer">Vue 编译三部曲：最后一曲，render code 生成</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/3fMZN_LidCi5fiD16nNWWA" target="_blank" rel="noopener noreferrer">字节一面：TCP 和 UDP 可以使用同一个端口吗</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/-z809aeSyvZsdKcWKSUrgA" target="_blank" rel="noopener noreferrer">如何在繁重的工作中管理好自己的时间和精力</a></p><p>📒 <a href="https://juejin.cn/post/7121378029682556958" target="_blank" rel="noopener noreferrer">「万字总结」🍒动画 + 大白话讲清楚React渲染原理</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/-UOG3Pn9aNxRMBtncGjF-w" target="_blank" rel="noopener noreferrer">Go语言中常见100问题-#85 Not using table-driven tests</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/JmHNfU11kbHGOnHi4kCcmQ" target="_blank" rel="noopener noreferrer">小程序不让用 JS 解释器？那我再肛一次鹅厂</a></p></div><footer class="row docusaurus-mt-lg"></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/frontend-weekly/blog/7月24日内容汇总">7月24日内容汇总</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-07-24T00:00:00.000Z" itemprop="datePublished">July 24, 2022</time> · <!-- -->8 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/43509711?v=4" alt="加菲猫"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/Jiacheng787" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">加菲猫</span></a></div><small class="avatar__subtitle" itemprop="description">前端开发 @NETEASE</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>📒 NestJS v9 发布</p><blockquote><p><a href="https://trilon.io/blog/nestjs-9-is-now-available" target="_blank" rel="noopener noreferrer">https://trilon.io/blog/nestjs-9-is-now-available</a></p></blockquote><p>📒 如何遍历 <code>map</code></p><p>首先，<code>map</code> 本身是可迭代对象，可以通过 <code>for...of</code> 遍历。</p><p>第二，可以将 <code>map</code> 转为数组进行遍历，实际还是利用了迭代器接口，但是可以利用数组方法链式调用。</p><blockquote><p><code>map</code> 默认迭代器接口是 <code>entries</code>，可以自定义例如 <code>[...map.values()]</code></p></blockquote><p>📒 开发小技巧</p><p>Antd 的 Modal 既可以通过组件方式，也可以通过 modal method 方式使用，后者比组件更方便，不需要自己维护状态，但是会有一个问题，如果需要通过弹框内部的按钮，控制弹框更新、关闭，我们没办法直接给弹框内部的元素传递 <code>modal.update</code>，因为此时 <code>Modal.success()</code> 还没有执行结束，<code>modal</code> 是 <code>undefined</code>，如何解决呢？</p><p>实际上可以通过不可变引用解决这个问题，我们先定义一个对象 <code>ctx</code>，在里面定义一个 <code>update</code> 方法，但什么也不做。然后给弹框内部按钮传入 <code>(e) =&gt; ctx.update(e)</code>，这样是可以正常调用，不会报错。然后在 <code>Modal.success()</code> 执行完成之后，这个时候就可以访问 <code>modal</code> 对象了，我们用 <code>modal.update</code> 去替换之前的空函数，这样当事件触发之后，调用的 <code>modal.update()</code> 就可以控制弹框更新了。</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">renderQuizModal</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  quizId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unitId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  handleOk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ctx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">update</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> CheckboxChangeEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> modal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Modal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> quizName</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    width</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    okButtonProps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      disabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    content</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Checkbox onChange</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> CheckboxChangeEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        勾选此项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Checkbox</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">onOk</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      handleOk</span><span class="token operator" style="color:#393A34">?.</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function" style="color:#d73a49">update</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> CheckboxChangeEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    modal</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      okButtonProps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        disabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">checked</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如何强制重新挂载组件？如果修改 <code>props</code> 或者 <code>setState</code> 只是触发组件 rerender，实际上是组件更新的过程，有时候需要强制组件重新挂载，可以修改组件的 <code>key</code>。</p><p>为何有时候没有给域名配置 host 还是可以访问？这是因为在容器中部署，可以通过 Docker 的 Networking 实现容器通信。</p><p>⭐️ <a href="https://juejin.cn/post/7122617883837857806" target="_blank" rel="noopener noreferrer">「React进阶」React中没有keepalive？没事！手把手教你从零到一设计并实现一个！</a></p><p>⭐️ <a href="https://mp.weixin.qq.com/s/MNw8SBvQLJ7WtNPROEL9og" target="_blank" rel="noopener noreferrer">现在前端面试都问什么「字节、蚂蚁、美团、滴滴面试小记」</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/aXsmf95WsB31r5PnOZEF9A" target="_blank" rel="noopener noreferrer">2022 年值得推荐的 Vue 库</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/jqRxNAI5C2NdxVX-pthFpg" target="_blank" rel="noopener noreferrer">【第2676期】一个 Safari 的小 Bug，探索出了 fetch 和 xhr的新玩法</a></p><p>📒 <a href="https://juejin.cn/post/7122114817581645832" target="_blank" rel="noopener noreferrer">Vite 也可以模块联邦</a></p><p>📒 <a href="https://juejin.cn/post/7121929203032784910" target="_blank" rel="noopener noreferrer">开发一个 CLI 模板库可以点亮哪些技能点</a></p><p>📒 Golang 实现一个 JS 打包器</p><p>Golang 解析 JS AST：</p><ul><li><a href="https://github.com/robertkrimen/otto" target="_blank" rel="noopener noreferrer">https://github.com/robertkrimen/otto</a></li><li><a href="https://pkg.go.dev/github.com/robertkrimen/otto/parser" target="_blank" rel="noopener noreferrer">https://pkg.go.dev/github.com/robertkrimen/otto/parser</a></li></ul><p>Webpack 打包原理：</p><ul><li><a href="https://juejin.cn/post/6854573217336541192" target="_blank" rel="noopener noreferrer">手写webpack核心原理，再也不怕面试官问我webpack原理</a></li><li><a href="https://juejin.cn/post/6961961165656326152" target="_blank" rel="noopener noreferrer">做了一夜动画，让大家十分钟搞懂Webpack</a></li></ul><p>📒 <a href="https://juejin.cn/post/6893338774088974343" target="_blank" rel="noopener noreferrer">天天造轮子第七天 - 中间件实现 - Compose 的 N 种姿势</a></p><p>📒 <a href="https://juejin.cn/post/7117886038126624805" target="_blank" rel="noopener noreferrer">使用Vite和TypeScript带你从零打造一个属于自己的Vue3组件库</a></p><p>📒 <a href="https://mp.weixin.qq.com/s/rFb07qMzV-JrzvVlDEgUAg" target="_blank" rel="noopener noreferrer">如何使用 React Hooks 重构类组件</a></p><p>📒 Why DRY is the most over-rated programming principle</p><blockquote><p><a href="https://gordonc.bearblog.dev/dry-most-over-rated-programming-principle/" target="_blank" rel="noopener noreferrer">https://gordonc.bearblog.dev/dry-most-over-rated-programming-principle/</a></p></blockquote><p>📒 What makes a great software engineer</p><blockquote><p><a href="https://swizec.com/blog/what-makes-a-great-software-engineer/" target="_blank" rel="noopener noreferrer">https://swizec.com/blog/what-makes-a-great-software-engineer/</a></p></blockquote><p>📒 构建面向未来的前端架构</p><p>本文是关于前端架构的组件部分。如果有写过组件，可能都有遇到随着业务迭代而快速增加复杂度，最终写出臃肿不堪难以维护的组件。为啥别人写的代码简洁易懂？缺的是经验吗？不是，缺的是方法论。我觉得此方法同样适用非组件场景。</p><p>心智模型的重要性。心智模型会影响我们的决定，进而影响代码的整体结构。如果一直做错误的大大小小的决定，那代码很快就会变成屎山。每个人的心智模型不可能完全一样，所以注定会做出不同的决定。对于团队而言，用框架和工具约束，让大家不做或少做决定是个很好的策略，比如用 prettier 统一编码风格。</p><p>文中有个例子。你写了一个组件，过了一周，产品迭代，而之前写的组件不能很好满足新需求。这时你有两个选择，A）思考之前的抽象是否正确，如果不正确，分解了重新做，B）增加一个额外 props，组件里加一些恶心的条件判断。你会如何选择？你会在乎之前投入的沉没成本还是面向未来考虑更多？其实没有对错，注意 By Scene。</p><p>自上而下 vs. 自下而上。「你可以自上而下或自下而上地构建。也就是说，你可以从构建层次结构中较高的组件开始。在比较简单的例子中，通常自上而下更容易，而在较大的项目中，自下而上更容易，并在构建过程中编写测试。」</p><p>自上而下是直观的、能快速出货的，大家通常也会这么干。当涉及到分解用户界面时，在功能区域周围画上方框，然后成为你的组件。这种功能分解的过程是自上而下的，通常会直接导致创建具有特定抽象性的专门组件。需求会改变。而在几个迭代过程中，这些组件很容易迅速变成单体巨石组件。</p><p>单体巨石组件有不少问题，包括 1）不容易复用子组件 2）包变大，比如 SSR 场景可能只希望渲染第一时间被用户看到的组件从而提速 3）rerender 问题导致运行时性能不好，也会让代码复杂，出现很多不必要的 memo 调用 4）不好的抽象导致项目复杂，迭代困难。「敏捷软件开发最重要的经验之一是迭代的价值；这在软件开发的各个层面都是正确的，包括架构。」</p><p>自下而上不那么直观，最初可能比较慢。因为这种方式会产生很多小组件，而实际中不是每个小组件在最初都需要可复用。所以前期需要花更多时间和努力，让复杂性被封装在每个小组件里。好处是长远看会更快，因为适应性更强。同时避免了单体巨石组件和前面介绍的他会带来的大量问题。</p><blockquote><p><a href="https://frontendmastery.com/posts/building-future-facing-frontend-architectures/" target="_blank" rel="noopener noreferrer">https://frontendmastery.com/posts/building-future-facing-frontend-architectures/</a></p></blockquote></div><footer class="row docusaurus-mt-lg"></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/frontend-weekly/blog/page/2"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/frontend-weekly/blog">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/garfield-dev-team/Garfield-cli" target="_blank" rel="noopener noreferrer" class="footer__link-item">Garfield-cli 前端工程化<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Jiacheng787/Garfield-utils" target="_blank" rel="noopener noreferrer" class="footer__link-item">NPM 工程化规范<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Jiacheng787/React-zero-to-one" target="_blank" rel="noopener noreferrer" class="footer__link-item">React 从零到一工程化指北<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Jiacheng787/go-by-example" target="_blank" rel="noopener noreferrer" class="footer__link-item">Golang 学习<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Jiacheng787/Bytedance-interview" target="_blank" rel="noopener noreferrer" class="footer__link-item">面试内容汇总<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Garfield Dev Team. Built with Docusaurus. Deploys on GitHub Pages.</div></div></div></footer></div>
<script src="/frontend-weekly/assets/js/runtime~main.a6d94b7a.js"></script>
<script src="/frontend-weekly/assets/js/main.30b81cc3.js"></script>
</body>
</html>